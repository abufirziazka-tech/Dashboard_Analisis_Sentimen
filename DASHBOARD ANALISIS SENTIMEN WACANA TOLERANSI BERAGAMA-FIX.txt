# =============================== #
# âœ… FINAL SINGLE-CELL (COLAB)
# ğŸ“˜ ANALISIS TOLERANSI BERAGAMA â€” FULL PIPELINE (Diperbaiki)
# ===============================

# 0) IMPORT PERTAMA: re HARUS DI ATAS SEBELUM INSTAL
import re  # ğŸ”´ WAJIB: Hindari error 're not defined'
import sys, subprocess, importlib, os

def pip_install(pkgs):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "-q"] + pkgs)

# ğŸ”§ PERBAIKAN: Downgrade numpy â†’ kompatibel dengan transformers (opsional)
try:
    import numpy as np  # jika sudah tersedia, lewati uninstall
except Exception:
    pass

# Install dependencies (coba pasang jika belum ada)
reqs = [
    ("pyarabic", "pyarabic"),
    ("gradio", "gradio>=4.36.0"),
    ("transformers", "transformers>=4.41.0"),
    ("pandas", "pandas"),
    ("matplotlib", "matplotlib"),
    ("PIL", "Pillow"),
    ("torch", "torch"),
    ("scikit_learn", "scikit-learn"),
    ("gensim", "gensim"),
    ("sentence-transformers", "sentence-transformers")
]
for mod, pkg in reqs:
    try:
        if mod == "PIL":
            importlib.import_module("PIL")
        else:
            importlib.import_module(mod)
    except Exception:
        pip_install([pkg])

# 1) IMPORT (SISANYA)
import gradio as gr
import torch
from transformers import AutoTokenizer, AutoModelForSequenceClassification, pipeline
from sentence_transformers import SentenceTransformer
from pyarabic.araby import strip_tashkeel, normalize_hamza
import pandas as pd
import matplotlib
matplotlib.use("Agg")
import matplotlib.pyplot as plt
from io import BytesIO
from PIL import Image
import numpy as np
from sklearn.metrics.pairwise import cosine_similarity
from sklearn.metrics import confusion_matrix, classification_report, accuracy_score, precision_recall_fscore_support
from gensim import corpora
from gensim.models import LdaModel

# 2) Device
device = 0 if torch.cuda.is_available() else -1
print(f"âš™ï¸ Device = {'CUDA' if device==0 else 'CPU'}")

# 3) Model (HF)
MODEL_CAMEL = "CAMeL-Lab/bert-base-arabic-camelbert-mix-sentiment"
MODEL_ARABERT_FT = "PRAli22/AraBert-Arabic-Sentiment-Analysis"
MODEL_SBERT = "sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2"

# 4) Load Models dengan fallback aman
pipe_camel = None
pipe_arabert = None
sbert_model = None
camel_loaded = False
arabert_loaded = False
sbert_loaded = False
camel_err = ""
arabert_err = ""
sbert_err = ""

print(f"ğŸ“¥ Memuat CAMeLBERT: {MODEL_CAMEL}...")
try:
    camel_tok = AutoTokenizer.from_pretrained(MODEL_CAMEL)
    camel_mod = AutoModelForSequenceClassification.from_pretrained(MODEL_CAMEL)
    pipe_camel = pipeline("sentiment-analysis", model=camel_mod, tokenizer=camel_tok, device=device)
    camel_loaded = True
    print("âœ… CAMeLBERT siap.")
except Exception as e:
    camel_err = str(e)
    print(f"âš ï¸ CAMeLBERT gagal dimuat â†’ {camel_err}")

print(f"ğŸ“¥ Memuat AraBERT (fine-tuned): {MODEL_ARABERT_FT}...")
try:
    arabert_tok = AutoTokenizer.from_pretrained(MODEL_ARABERT_FT)
    arabert_mod = AutoModelForSequenceClassification.from_pretrained(MODEL_ARABERT_FT)
    pipe_arabert = pipeline("sentiment-analysis", model=arabert_mod, tokenizer=arabert_tok, device=device)
    arabert_loaded = True
    print("âœ… AraBERT siap.")
except Exception as e:
    arabert_err = str(e)
    print(f"âš ï¸ AraBERT gagal dimuat â†’ {arabert_err}")

print(f"ğŸ“¥ Memuat Sentence-BERT untuk Semantic Similarity: {MODEL_SBERT}...")
try:
    sbert_model = SentenceTransformer(MODEL_SBERT)
    sbert_loaded = True
    print("âœ… SBERT siap.")
except Exception as e:
    sbert_err = str(e)
    print(f"âš ï¸ SBERT gagal dimuat â†’ {sbert_err}")

# 5) Normalisasi & utilitas teks Arab
QURAN_STOPMARKS = r"[ÛÛ©ÛÛ™ÛšÛ›Û—Û˜Û™ÛœÛ–Û—]|[ï·²ï·º]"
AYAH_NUMBERS = r"\(?\d{1,3}\)?"
AR_PUNCTS = "ØŸØŒØ›!.,:Ø›â€¦"

def normalize_lam_alef(text):
    return text.replace('Ù„Ø£', 'Ù„Ø§').replace('Ù„Ø¥', 'Ù„Ø§').replace('Ù„Ø¢', 'Ù„Ø§')

def normalize_arabic(text: str) -> str:
    if not text:
        return ""
    t = strip_tashkeel(text)
    t = normalize_hamza(t)
    t = normalize_lam_alef(t)
    t = re.sub(r"[Ø¥Ø£Ù±Ø¢Ø§]", "Ø§", t)
    t = re.sub(r"Ù‰", "ÙŠ", t)
    t = re.sub(r"Ø¤", "Ùˆ", t)
    t = re.sub(r"Ø¦", "ÙŠ", t)
    t = re.sub(r"Ø©", "Ù‡", t)
    t = re.sub(QURAN_STOPMARKS, " ", t)
    t = re.sub(AYAH_NUMBERS, " ", t)
    t = re.sub(r"\s+", " ", t).strip()
    return t

def ar_sentence_split(text: str):
    if not text:
        return []
    parts = re.split(r"[\.\!\?"+AR_PUNCTS+r"]+", text)
    return [p.strip() for p in parts if p and len(p.strip())>0]

# 6) Resource: Ayat Sensitif, Maqashid, Frasa, dan Hermeneutik (DIPERLUAS >300 ENTRI)
SENSITIVE_VERSES = {
    "Ù„Ø§ Ø¥ÙƒØ±Ø§Ù‡ ÙÙŠ Ø§Ù„Ø¯ÙŠÙ†": {
        "warning": "ğŸŸ¢ Ayat toleransi utama: tidak ada paksaan dalam agama.",
        "context": "QS. Al-Baqarah:256 harus dibaca bersama QS. Yunus:99.",
        "maqashid": ["Hifz ad-Din", "Hifz al-Aql"],
        "override_sentiment": {"positive": 0.95, "neutral": 0.05, "negative": 0.0},
        "intertextual": {
            "related_verses": ["QS. Yunus:99", "QS. Al-Kahf:29", "QS. Al-Ghasyiyah:21-22"],
            "explanation": "Ayat ini terkait dengan prinsip kebebasan beragama yang juga ditegaskan dalam ayat-ayat lain tentang tidak adanya paksaan dalam iman."
        },
        "historical_context": "Ayat ini turun dalam konteks masyarakat Madinah yang pluralistik, dimana Nabi Muhammad SAW membangun piagam Madinah yang mengakui keberagaman agama.",
        "philosophical_theological": "Prinsip ini menunjukkan penghormatan Islam terhadap otonomi conscience manusia dalam memilih keyakinan, yang merupakan fondasi teologi toleransi dalam Islam."
    },
    "Ù„ÙƒÙ… Ø¯ÙŠÙ†ÙƒÙ… ÙˆÙ„ÙŠ Ø¯ÙŠÙ†": {
        "warning": "ğŸŸ¢ Ayat toleransi fundamental: penghormatan terhadap perbedaan keyakinan.",
        "context": "Diturunkan sebagai penegasan damai terhadap kaum musyrik.",
        "maqashid": ["Hifz ad-Din"],
        "override_sentiment": {"positive": 0.95, "neutral": 0.05, "negative": 0.0},
        "intertextual": {
            "related_verses": ["QS. Al-Baqarah:256", "QS. Al-An'am:108"],
            "explanation": "Ayat ini menunjukkan pengakuan terhadap keberadaan agama lain tanpa kompromi dalam keyakinan tauhid."
        },
        "historical_context": "Turun sebagai respons terhadap tawaran kompromi dari kaum musyrik Quraisy yang ingin melakukan sinkretisme agama.",
        "philosophical_theological": "Mencerminkan prinsip 'agree to disagree' yang sophisticated dalam teologi Islam, mengakui perbedaan tanpa relativisme truth claim."
    },
    "Ù…Ø§ Ø£Ù†Øª Ø¹Ù„ÙŠÙ‡Ù… Ø¨Ù…Ø¶Ø·Ø±": {
        "warning": "ğŸŸ¢ Penegasan bahwa dakwah bukan paksaan.",
        "context": "QS. Al-Ghashiyah:22 menegaskan bahwa Rasul hanya bertugas menyampaikan, bukan memaksa.",
        "maqashid": ["Hifz ad-Din", "Hifz al-Aql"],
        "override_sentiment": {"positive": 0.94, "neutral": 0.06, "negative": 0.0},
        "intertextual": {
            "related_verses": ["QS. Al-Baqarah:256", "QS. Yunus:41"],
            "explanation": "Menunjukkan batasan peran nabi dalam menyampaikan risalah."
        }
    },
    "ÙˆÙ„Ùˆ Ø´Ø§Ø¡ Ø±Ø¨Ùƒ Ù„Ø¢Ù…Ù† Ù…Ù† ÙÙŠ Ø§Ù„Ø£Ø±Ø¶ ÙƒÙ„Ù‡Ù… Ø¬Ù…ÙŠØ¹Ø§Ù‹": {
        "warning": "ğŸŸ¢ Keimanan adalah hak prerogatif Allah.",
        "context": "QS. Yunus:99 menunjukkan bahwa iman tidak bisa dipaksakan.",
        "maqashid": ["Hifz ad-Din"],
        "override_sentiment": {"positive": 0.93, "neutral": 0.07, "negative": 0.0}
    },
    "ÙˆÙ„Ø§ ØªØ³Ø¨ÙˆØ§ Ø§Ù„Ø°ÙŠÙ† ÙŠØ¯Ø¹ÙˆÙ† Ù…Ù† Ø¯ÙˆÙ† Ø§Ù„Ù„Ù‡": {
        "warning": "ğŸŸ¢ Larangan provokasi terhadap pemeluk agama lain.",
        "context": "QS. Al-An'am:108 melarang ejekan terhadap simbol agama lain.",
        "maqashid": ["Hifz an-Nafs", "Hifz al-Mal"],
        "override_sentiment": {"positive": 0.90, "neutral": 0.10, "negative": 0.0}
    },
    "Ø§Ø¯Ø®Ù„ÙˆØ§ ÙÙŠ Ø§Ù„Ø³Ù„Ù… ÙƒØ§ÙØ©": {
        "warning": "ğŸŸ¢ Seruan perdamaian universal.",
        "context": "QS. Al-Baqarah:208 mengajak umat masuk ke dalam kedamaian secara menyeluruh.",
        "maqashid": ["Hifz an-Nafs", "Hifz ad-Din"],
        "override_sentiment": {"positive": 0.92, "neutral": 0.08, "negative": 0.0}
    },
    "ÙˆØ£Ù„Ù Ø¨ÙŠÙ† Ù‚Ù„ÙˆØ¨Ù‡Ù…": {
        "warning": "ğŸŸ¢ Doa Nabi untuk persatuan umat.",
        "context": "QS. Al-Hashr:10 menunjukkan harapan persaudaraan antarumat.",
        "maqashid": ["Hifz an-Nafs", "Hifz ad-Din"],
        "override_sentiment": {"positive": 0.91, "neutral": 0.09, "negative": 0.0}
    }
}

INTERTEXTUAL_DB = {
    "Ù‚ØªÙ„": {
        "related_verses": ["QS. Al-Maidah:32", "QS. Al-Isra:33", "QS. Al-Furqan:68"],
        "theme": "Sanctity of Life",
        "explanation": "Ayat-ayat tentang pembunuhan saling melengkapi dalam membentuk etika kehidupan dalam Islam."
    },
    "Ø§Ù„Ø³Ù„Ø§Ù…": {
        "related_verses": ["QS. Al-Anfal:61", "QS. Al-Hujurat:10-13", "QS. An-Nisa:94"],
        "theme": "Peace and Reconciliation",
        "explanation": "Konsep perdamaian dalam Islam bersifat komprehensif dan multidimensi."
    },
    "Ø§Ù„Ø¹Ø¯Ù„": {
        "related_verses": ["QS. Al-Maidah:8", "QS. An-Nahl:90", "QS. Al-Hujurat:13"],
        "theme": "Justice and Equality",
        "explanation": "Keadilan adalah nilai sentral dalam Islam, berlaku untuk semua manusia tanpa diskriminasi."
    },
    "Ø§Ù„Ø¨Ø±": {
        "related_verses": ["QS. Al-Mumtahanah:8", "QS. Al-Balad:17", "QS. Al-Insan:8"],
        "theme": "Kindness to Others",
        "explanation": "Berbuat baik kepada non-Muslim yang damai adalah ajaran inti dalam Islam."
    },
    "Ø§Ù„Ø±Ø­Ù…Ø©": {
        "related_verses": ["QS. Al-Anbiya:107", "QS. Al-A'raf:156", "QS. Luqman:13"],
        "theme": "Divine and Human Mercy",
        "explanation": "Rahmat Allah universal, mencakup semua makhluk, bukan hanya Muslim."
    },
    "Ø§Ù„ØªÙÙ‘Ø¹ÙØ§Ø±ÙÙ": {
        "related_verses": ["QS. Al-Hujurat:13", "QS. Al-Rum:22", "QS. Fussilat:53"],
        "theme": "Mutual Recognition",
        "explanation": "Perbedaan suku dan bangsa adalah sunnatullah untuk saling mengenal."
    },
    "Ø§Ù„Ù’Ù…ÙÙˆÙØ§Ø·ÙÙ†ÙØ©": {
        "related_verses": ["QS. Al-Mumtahanah:8", "QS. Al-Kafirun:6", "QS. Al-Hujurat:13"],
        "theme": "Citizenship and Coexistence",
        "explanation": "Islam mengakui kehidupan bersama sebagai warga negara yang setara."
    },
    "Ø§Ù„Ù’Ø­ÙØ±ÙÙ‘ÙŠÙÙ‘Ø©": {
        "related_verses": ["QS. Al-Baqarah:256", "QS. Yunus:41", "QS. Al-Ghashiyah:22"],
        "theme": "Freedom of Belief",
        "explanation": "Kebebasan beragama adalah hak asasi yang dilindungi syariah."
    },
    "Ø§Ù„Ù’Ø­ÙÙƒÙ’Ù…ÙØ©": {
        "related_verses": ["QS. An-Nahl:125", "QS. Luqman:17", "QS. Al-Imran:159"],
        "theme": "Wisdom in Da'wah",
        "explanation": "Dakwah harus disampaikan dengan hikmah dan nasihat yang baik."
    },
    "Ø§Ù„Ù’Ù…ÙØ¬ÙØ§Ø¯ÙÙ„ÙØ© Ø¨ÙØ§Ù„ÙÙ‘ØªÙÙŠ Ù‡ÙÙŠÙ Ø£ÙØ­Ù’Ø³ÙÙ†Ù": {
        "related_verses": ["QS. Al-Ankabut:46", "QS. Al-Zumar:18", "QS. Ghafir:33"],
        "theme": "Civil Dialogue",
        "explanation": "Dialog dengan Ahli Kitab harus dilakukan dengan cara terbaik."
    }
}

HISTORICAL_CONTEXT_DB = {
    "Ù…ÙŠØ«Ø§Ù‚": {
        "context": "Konsep perjanjian dalam Islam didasarkan pada Piagam Madinah yang mengakui pluralitas agama.",
        "significance": "Landasan historis untuk masyarakat multireligius dalam sejarah Islam."
    },
    "Ø£Ù‡Ù„ Ø§Ù„ÙƒØªØ§Ø¨": {
        "context": "Terminologi ini berkembang dalam dialog antara Muslim dengan Yahudi dan Kristen di Madinah.",
        "significance": "Menunjukkan pengakuan khusus terhadap komunitas agama yang memiliki kitab suci."
    },
    "Ø°Ù…Ø©": {
        "context": "Status hukum non-Muslim yang hidup di bawah perlindungan negara Islam.",
        "significance": "Menjamin hak-hak sipil dan keamanan jiwa serta harta."
    },
    "Ø¬Ø²ÙŠØ©": {
        "context": "Pajak yang dibayar oleh non-Muslim sebagai ganti layanan negara dan pembebasan dari wajib militer.",
        "significance": "Bagian dari kontrak sosial dalam masyarakat Islam."
    },
    "Ø¯Ø§Ø± Ø§Ù„Ø³Ù„Ø§Ù…": {
        "context": "Istilah untuk wilayah damai di mana hukum Islam diterapkan secara adil bagi semua warga.",
        "significance": "Konsep inklusivitas dan keamanan kolektif."
    }
}

PHILOSOPHICAL_CONCEPTS = {
    "Ø§Ù„ØªØ³Ø§Ù…Ø­": {
        "concept": "Toleransi dalam Islam bukan sekadar membiarkan, tetapi aktif menghargai perbedaan, menjaga martabat, dan membangun kedamaian antarumat beragama.",
        "theological_basis": "Berdasarkan pada konsep 'Ù„Ø§ Ø¥ÙƒØ±Ø§Ù‡ ÙÙŠ Ø§Ù„Ø¯ÙŠÙ†' (QS. Al-Baqarah 2:256) dan kemuliaan manusia sebagai makhluk bernilai (karamah insaniyah), sebagaimana ditegaskan dalam QS. Al-Isra 17:70."
    },
    "Ø§Ù„Ø¹Ø¯Ù„": {
        "concept": "Keadilan dalam Islam bersifat universal, mencakup semua manusia tanpa diskriminasi, baik Muslim maupun non-Muslim, dalam hak, perlakuan, dan hukum.",
        "theological_basis": "Merupakan salah satu sifat Allah (Al-Adl) dan prinsip fundamental syariah. Ditegaskan dalam QS. Al-Maidah 5:8: 'Dan janganlah kebencianmu terhadap suatu kaum mendorongmu untuk berlaku tidak adil.'"
    },
    "Ø§Ù„Ø±Ø­Ù…Ø©": {
        "concept": "Rahmat dalam Islam mencakup semua makhluk, tidak terbatas pada Muslim saja, melainkan rahmat yang universal bagi alam semesta.",
        "theological_basis": "Terdapat dalam konsep 'Ø±ÙØ­Ù’Ù…ÙØ©Ù‹ Ù„ÙÙ‘Ù„Ù’Ø¹ÙØ§Ù„ÙÙ…ÙÙŠÙ†Ù' (rahmatan lil-'alamin) yang menjadi tujuan utama diutusnya Nabi Muhammad (QS. Al-Anbiya 21:107)."
    },
    "Ø§Ù„ØªÙÙ‘Ø¹ÙØ§Ø±ÙÙ": {
        "concept": "Manusia diciptakan berbangsa-bangsa dan bersuku-suku bukan untuk saling memusuhi, melainkan agar saling mengenal, memahami, dan mempererat hubungan kemanusiaan.",
        "theological_basis": "Ditegaskan dalam QS. Al-Hujurat 49:13: '...ÙˆÙØ¬ÙØ¹ÙÙ„Ù’Ù†ÙØ§ÙƒÙÙ…Ù’ Ø´ÙØ¹ÙÙˆØ¨Ù‹Ø§ ÙˆÙÙ‚ÙØ¨ÙØ§Ø¦ÙÙ„Ù Ù„ÙØªÙØ¹ÙØ§Ø±ÙÙÙÙˆØ§'. Perbedaan adalah sunnatullah yang harus dihargai."
    },
    "Ø§Ù„Ø³ÙÙ‘Ù„ÙØ§Ù…": {
        "concept": "Islam sebagai agama perdamaian menekankan pentingnya hidup damai, dialog, dan penolakan terhadap permusuhan yang tidak perlu, terutama dengan pemeluk agama lain yang damai.",
        "theological_basis": "Nama Allah 'As-Salam' (Sumber Kedamaian) dan perintah untuk merespons ajakan damai: 'ÙˆÙØ¥ÙÙ† Ø¬ÙÙ†ÙØ­ÙÙˆØ§ Ù„ÙÙ„Ø³ÙÙ‘Ù„ÙØ§Ù…Ù ÙÙØ§Ø¬Ù’Ù†ÙØ­Ù’ Ù„ÙÙ‡ÙØ§' (QS. Al-Anfal 8:61)."
    },
    "Ø§Ù„Ù’Ø¥ÙØ­Ù’Ø³ÙØ§Ù†": {
        "concept": "Berbuat baik (ihsan) melampaui keadilan; mencakup sikap santun, murah hati, dan empati terhadap semua orang, termasuk yang berbeda keyakinan.",
        "theological_basis": "Allah memerintahkan ihsan terhadap semua makhluk (QS. An-Nahl 16:90), dan Nabi Muhammad bersabda: 'Ø£Ø­Ø³Ù† Ø§Ù„Ù†Ø§Ø³ ØµØ­Ø¨Ø© Ø®ÙŠØ±Ù‡Ù… Ù„Ù„Ù†Ø§Ø³' (Orang terbaik adalah yang paling baik kepada manusia)."
    },
    "Ø§Ù„Ù’Ø­ÙØ±ÙÙ‘ÙŠÙÙ‘Ø©": {
        "concept": "Kebebasan beragama adalah hak asasi manusia dalam Islam. Iman harus lahir dari kesadaran, bukan paksaan.",
        "theological_basis": "Prinsip 'Ù„Ø§ Ø¥ÙƒØ±Ø§Ù‡ ÙÙŠ Ø§Ù„Ø¯ÙŠÙ†' (QS. Al-Baqarah 2:256) menegaskan bahwa keyakinan tidak bisa dipaksakan. Jiwa manusia harus bebas memilih jalan hidupnya."
    },
    "Ø§Ù„Ù’Ø­ÙÙƒÙ’Ù…ÙØ©": {
        "concept": "Hikmah adalah pendekatan bijaksana dalam berdakwah dan berdialog antaragama, dengan mempertimbangkan konteks, budaya, dan kondisi lawan bicara.",
        "theological_basis": "Perintah berdakwah 'Ø¨Ø§Ù„Ø­ÙƒÙ…Ø© ÙˆØ§Ù„Ù…ÙˆØ¹Ø¸Ø© Ø§Ù„Ø­Ø³Ù†Ø©' (QS. An-Nahl 16:125) menunjukkan bahwa kebenaran harus disampaikan dengan cara yang paling mulia dan efektif."
    },
    "Ø§Ù„Ù’Ù…ÙÙˆÙØ§Ø·ÙÙ†ÙØ©": {
        "concept": "Kehidupan bersama sebagai warga negara yang setara, saling menghormati, dan bekerja sama untuk kebaikan bersama, tanpa memandang agama.",
        "theological_basis": "QS. Al-Mumtahanah 60:8 menyatakan bahwa Allah tidak melarang berbuat baik dan adil terhadap mereka yang tidak memerangi kita: 'Ø¥ÙÙ†ÙÙ‘ Ø§Ù„Ù„ÙÙ‘Ù‡Ù ÙŠÙØ­ÙØ¨ÙÙ‘ Ø§Ù„Ù’Ù…ÙÙ‚Ù’Ø³ÙØ·ÙÙŠÙ†Ù'."
    },
    "Ø§Ù„Ù’Ù…ÙØ¬ÙØ§Ø¯ÙÙ„ÙØ© Ø¨ÙØ§Ù„ÙÙ‘ØªÙÙŠ Ù‡ÙÙŠÙ Ø£ÙØ­Ù’Ø³ÙÙ†Ù": {
        "concept": "Dialog antaragama harus dilakukan dengan cara terbaik â€” penuh hormat, logis, dan tanpa ejekan â€” untuk membangun saling pengertian.",
        "theological_basis": "QS. Al-Ankabut 29:46: 'ÙˆÙÙ„ÙØ§ ØªÙØ¬ÙØ§Ø¯ÙÙ„ÙÙˆØ§ Ø£ÙÙ‡Ù’Ù„Ù Ø§Ù„Ù’ÙƒÙØªÙØ§Ø¨Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ø¨ÙØ§Ù„ÙÙ‘ØªÙÙŠ Ù‡ÙÙŠÙ Ø£ÙØ­Ù’Ø³ÙÙ†Ù' menekankan etika dialog dengan Ahli Kitab (Yahudi, Nasrani)."
    }
}

maqashid_map = {
    "Hifz ad-Din": ["Ø¯ÙŠÙ†","Ø´Ø±Ùƒ","Ø¹Ø¨Ø§Ø¯Ù‡","Ø§ÙŠÙ…Ø§Ù†","ØªÙˆØ­ÙŠØ¯","ØµÙ„Ø§Ù‡","Ø²ÙƒØ§Ù‡","Ø­Ø¬","Ø§Ù„Ù‚Ø±Ø¢Ù†","Ø³Ù†Ù‡","Ø§Ù„Ù„Ù‡","Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø§Ø®Ø±","Ø§Ù„Ø¬Ù†Ù‡","Ø§Ù„Ù†Ø§Ø±","Ø§Ù„ÙˆØ­ÙŠ","Ø§Ù„Ù†Ø¨ÙˆÙ‡","Ø§Ù„Ø±Ø³ÙˆÙ„","Ø§Ù„Ù…Ø­Ø¨Ù‡ ÙÙŠ Ø§Ù„Ù„Ù‡","Ø§Ù„ÙˆÙ„Ø§Ø¡ ÙˆØ§Ù„Ø¨Ø±Ø§Ø¡"],
    "Hifz an-Nafs": ["Ù‚ØªÙ„","Ø­ÙŠØ§Ù‡","Ù†ÙØ³","ØµØ­Ù‡","Ø³Ù„Ø§Ù…Ù‡","Ø§Ù…Ù†","Ø­Ù…Ø§ÙŠÙ‡","Ø¹Ù„Ø§Ø¬","Ø¯ÙˆØ§Ø¡","Ù…Ø£ÙˆÙ‰","Ø§Ù„Ù‚ØªØ§Ù„ Ø¯ÙØ§Ø¹Ø§Ù‹ Ø¹Ù† Ø§Ù„Ù†ÙØ³","Ø§Ù„Ø§Ø³ØªØ´Ù‡Ø§Ø¯","Ø§Ù„Ø§Ø³Ø¹Ø§Ù","Ø§Ù„Ø±Ø¹Ø§ÙŠÙ‡ Ø§Ù„ØµØ­ÙŠÙ‡","Ø§Ù„ØªØ·Ø¹ÙŠÙ…","Ø§Ù„ÙˆÙ‚Ø§ÙŠÙ‡","Ø§Ù„Ù†Ø¸Ø§ÙÙ‡","Ø§Ù„Ù…Ø§Ø¡ Ø§Ù„Ù†Ù‚ÙŠ","Ø§Ù„Ù‡ÙˆØ§Ø¡ Ø§Ù„Ù†Ù‚ÙŠ"],
    "Hifz al-Aql": ["Ø¹Ù‚Ù„","Ø¹Ù„Ù…","ÙÙƒØ±","ØªØ¹Ù„ÙŠÙ…","ØªØ¹Ù„Ù…","Ø¨Ø­Ø«","Ø¯Ø±Ø§Ø³Ù‡","ÙÙ‡Ù…","Ø­ÙƒÙ…Ù‡","ØªØ­Ù„ÙŠÙ„","Ù…Ù†Ø·Ù‚","Ø§Ù„Ù‚Ø±Ø§Ø¡Ù‡","Ø§Ù„ÙƒØªØ§Ø¨Ù‡","Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹","Ø§Ù„Ø§Ù†ØµØ§Øª","Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Ù‚Ø¯ÙŠ","Ø§Ù„Ø§Ø¨ØªÙƒØ§Ø±","Ø§Ù„Ø¬Ø§Ù…Ø¹Ù‡","Ø§Ù„Ù…Ø¯Ø±Ø³Ù‡","Ø§Ù„Ù„ØºÙ‡","Ø§Ù„Ù†Ø­Ùˆ","Ø§Ù„Ø¨Ù„Ø§ØºÙ‡","Ø§Ù„ÙÙ„Ø³ÙÙ‡","Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ø¹Ù‚Ù„ÙŠÙ‡"],
    "Hifz an-Nasl": ["Ù†Ø³Ù„","Ø¹Ø§Ø¦Ù„Ù‡","Ø²ÙˆØ§Ø¬","Ø§Ø¨Ù†Ø§Ø¡","Ø§Ø·ÙØ§Ù„","ØªØ±Ø¨ÙŠÙ‡","Ø§Ù…ÙˆÙ…Ù‡","Ø§Ø¨ÙˆÙ‡","Ø§Ù„Ø±Ø¶Ø§Ø¹Ù‡","Ø§Ù„Ø­Ù…Ù„","Ø§Ù„ÙˆÙ„Ø§Ø¯Ù‡","Ø§Ù„Ø·Ù„Ø§Ù‚","Ø§Ù„ÙˆØµØ§ÙŠÙ‡","Ø§Ù„Ø§Ø´Ø±Ø§Ù","Ø§Ù„Ø²ÙˆØ§Ø¬ Ø§Ù„Ø§Ø³Ù„Ø§Ù…ÙŠ","Ø§Ù„Ø²ÙˆØ§Ø¬ Ø§Ù„Ù…Ø¨ÙƒØ±","Ø§Ù„Ø§Ù‡Ù…Ø§Ù„","Ø§Ù„Ø§ÙŠØ°Ø§Ø¡","Ø§Ù„Ø­Ù…Ø§ÙŠÙ‡ Ù…Ù† Ø§Ù„Ø§Ø³ØªØºunakan"],
    "Hifz al-Mal": ["Ù…Ø§Ù„","Ø±Ø²Ù‚","Ø§Ø³ØªØ«Ù…Ø§Ø±","ØªØ¬Ø§Ø±Ù‡","Ø¹Ù…Ù„","ÙˆØ¸ÙŠÙÙ‡","Ø²ÙƒØ§Ù‡","ØµØ¯Ù‚Ù‡","ÙˆÙ‚Ù","Ø§Ù„Ø§ÙÙ„Ø§Ø³","Ø§Ù„Ø¯ÙŠÙ†","Ø§Ù„ØªØ³Ø§Ù…Ø­ ÙÙŠ Ø§Ù„Ù‚Ø±Ø¶","Ø§Ù„ØºØ´","Ø§Ù„Ø³Ø±Ù‚Ù‡","Ø§Ù„Ø±Ø´ÙˆÙ‡","Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„","Ø§Ù„Ø±Ø¨Ø§","Ø§Ù„Ø²ÙƒØ§Ù‡ Ø§Ù„Ù…Ø§Ù„ÙŠÙ‡","Ø§Ù„Ø§Ù†ÙØ§Ù‚ ÙÙŠ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù„Ù‡"]
}

toleransi_phrases = {
    "toleran": [
        # Konsep utama toleransi (damai, kasih, penghormatan) â€” >150 entri
        "Ø§Ù„Ø³Ù„Ø§Ù…", "Ø§Ù„Ø§Ù…Ø§Ù†", "Ø§Ù„Ø§Ù…Ù†", "Ø§Ù„ÙˆØ¦Ø§Ù…", "Ø§Ù„ÙˆÙØ§Ù‚", "Ø§Ù„Ù…Ø­Ø¨Ø©", "Ø§Ù„ÙˆØ¯", "Ø§Ù„Ø±Ø­Ù…Ø©", "Ø§Ù„Ø±Ø¶Ø§", "Ø§Ù„ØµÙØ­", "Ø§Ù„Ø¹ÙÙˆ", "Ø§Ù„ØªØ³Ø§Ù…Ø­", "Ø§Ù„Ù…Ø³Ø§Ù…Ø­Ø©", "Ø§Ù„ØµÙØ­", "Ø§Ù„Ø§Ø­Ø³Ø§Ù†", "Ø§Ù„Ø¨Ø±", "Ø§Ù„Ù„Ø·Ù", "Ø§Ù„Ø±ÙÙ‚", "Ø§Ù„Ù„ÙŠÙ†", "Ø§Ù„Ø­ÙÙ„Ù…", "Ø§Ù„ØµØ¨Ø±", "Ø§Ù„Ø³ÙƒÙŠÙ†Ø©", "Ø§Ù„Ø·Ù…Ø£Ù†ÙŠÙ†Ø©", "Ø§Ù„Ù‡Ø¯ÙˆØ¡", "Ø§Ù„Ø§Ø³ØªÙ‚Ø±Ø§Ø±", "Ø§Ù„Ø¹Ø¯Ù„", "Ø§Ù„Ù‚Ø³Ø·", "Ø§Ù„Ø¥Ù†ØµØ§Ù", "Ø§Ù„ØªÙˆØ§Ø²Ù†", "Ø§Ù„Ø§Ø¹ØªØ¯Ø§Ù„", "Ø§Ù„ÙˆØ³Ø·ÙŠØ©", "Ø§Ù„ØªÙØ§Ù‡Ù…", "Ø§Ù„ØªØ¹Ø§ÙˆÙ†", "Ø§Ù„ØªØ¢Ø®ÙŠ", "Ø§Ù„Ø§Ø®Ø§Ø¡", "Ø§Ù„Ù…ÙˆØ§Ø³Ø§Ø©", "Ø§Ù„ØªØ¹Ø§Ø·Ù", "Ø§Ù„ØªØ¹Ø§Ø¶Ø¯", "Ø§Ù„ØªØ±Ø§Ø­Ù…", "Ø§Ù„ØªÙƒØ§ÙÙ„", "Ø§Ù„Ø§Ø­ØªØ±Ø§Ù…", "Ø§Ù„ØªÙƒØ±ÙŠÙ…", "Ø§Ù„ØªÙ‚Ø¯ÙŠØ±", "Ø§Ù„Ø¥Ù†ØµØ§Øª", "Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹", "Ø§Ù„Ø­ÙˆØ§Ø±", "Ø§Ù„ÙƒÙ„Ø§Ù… Ø§Ù„Ø·ÙŠØ¨", "Ø§Ù„Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø¹Ø±ÙˆÙ", "Ø§Ù„Ù‚ÙˆÙ„ Ø§Ù„Ø­Ø³Ù†", "Ø§Ù„Ù‚ÙˆÙ„ Ø§Ù„Ø¨Ù„ÙŠØº", "Ø§Ù„Ø­Ø¬Ø© Ø§Ù„Ø¨ÙŠÙ‘Ù†Ø©", "Ø§Ù„Ø­Ø¬Ø© Ø§Ù„Ø­Ø³Ù†Ø©", "Ø§Ù„Ø¯Ø¹ÙˆØ© Ø¨Ø§Ù„Ø­ÙƒÙ…Ø©", "Ø¨Ø§Ù„ØªÙŠ Ù‡ÙŠ Ø£Ø­Ø³Ù†", "Ù„Ø§ Ø¥ÙƒØ±Ø§Ù‡ ÙÙŠ Ø§Ù„Ø¯ÙŠÙ†", "Ù„ÙƒÙ… Ø¯ÙŠÙ†ÙƒÙ… ÙˆÙ„ÙŠ Ø¯ÙŠÙ†", "Ù„Ø§ ØªØ³Ø¨ÙˆØ§ Ø£Ù‡Ù„ Ø§Ù„Ø£Ø¯ÙŠØ§Ù†", "Ù…Ù† ÙƒØ§Ù† ÙŠØ¤Ù…Ù† Ø¨Ø§Ù„Ù„Ù‡ ÙˆØ§Ù„ÙŠÙˆÙ… Ø§Ù„Ø¢Ø®Ø±", "Ù‚Ù„ ÙŠØ§ Ø£Ù‡Ù„ Ø§Ù„ÙƒØªØ§Ø¨ ØªØ¹Ø§Ù„ÙˆØ§ Ø¥Ù„Ù‰ ÙƒÙ„Ù…Ø© Ø³ÙˆØ§Ø¡", "ÙˆØ¥Ø°Ø§ Ø®Ø§Ø·Ø¨Ù‡Ù… Ø§Ù„Ø¬Ø§Ù‡Ù„ÙˆÙ† Ù‚Ø§Ù„ÙˆØ§ Ø³Ù„Ø§Ù…Ø§", "Ø§Ø¯Ø®Ù„ÙˆØ§ ÙÙŠ Ø§Ù„Ø³Ù„Ù… ÙƒØ§ÙØ©", "ÙˆØ£Ù„Ù Ø¨ÙŠÙ† Ù‚Ù„ÙˆØ¨Ù‡Ù…", "ÙƒÙ†ØªÙ… Ø®ÙŠØ± Ø£Ù…Ø©", "Ù„ÙƒÙ„ Ø£Ù…Ø© Ø¬Ø¹Ù„Ù†Ø§ Ù…Ù†Ø³ÙƒØ§", "Ù…Ù† ÙŠØµÙ„ÙŠ ÙˆÙŠØµÙˆÙ…", "ÙˆÙ„Ø§ ØªØ¬Ø§Ø¯Ù„ÙˆØ§ Ø£Ù‡Ù„ Ø§Ù„ÙƒØªØ§Ø¨ Ø¥Ù„Ø§ Ø¨Ø§Ù„ØªÙŠ Ù‡ÙŠ Ø£Ø­Ø³Ù†", "Ø§Ù„Ø°ÙŠÙ† Ù„Ø§ ÙŠØ´Ù‡Ø¯ÙˆÙ† Ø§Ù„Ø²ÙˆØ±", "ÙˆÙ‡Ù… Ø¹Ù„Ù‰ ØµÙ„Ø§ØªÙ‡Ù… ÙŠØ­Ø§ÙØ¸ÙˆÙ†", "ÙˆÙŠØ¤Ø«Ø±ÙˆÙ† Ø¹Ù„Ù‰ Ø£Ù†ÙØ³Ù‡Ù… ÙˆÙ„Ùˆ ÙƒØ§Ù† Ø¨Ù‡Ù… Ø®ØµØ§ØµØ©", "ÙˆÙŠÙƒØ¸Ù…ÙˆÙ† Ø§Ù„ØºÙŠØ¸", "ÙˆØ§Ù„Ø¹Ø§ÙÙŠÙ† Ø¹Ù† Ø§Ù„Ù†Ø§Ø³", "ÙˆØ§Ù„Ù„Ù‡ ÙŠØ­Ø¨ Ø§Ù„Ù…Ø­Ø³Ù†ÙŠÙ†", "ÙˆØ£ØµÙ„Ø­ Ø°Ø§Øª Ø¨ÙŠÙ†Ù‡Ù…", "ÙˆØ£ÙˆÙÙˆØ§ Ø¨Ø¹Ù‡Ø¯ Ø§Ù„Ù„Ù‡", "ÙˆØ£ÙˆÙÙˆØ§ Ø¨Ø§Ù„Ø¹Ù‡Ø¯", "ÙˆØ£ÙˆÙÙˆØ§ Ø¨Ø§Ù„ÙŠÙ…ÙŠÙ†", "ÙˆÙ„Ù† ØªØ±Ø¶Ù‰ Ø¹Ù†Ùƒ Ø§Ù„ÙŠÙ‡ÙˆØ¯ ÙˆÙ„Ø§ Ø§Ù„Ù†ØµØ§Ø±Ù‰ Ø­ØªÙ‰ ØªØªØ¨Ø¹ Ù…Ù„ØªÙ‡Ù…", "Ù‚Ù„ Ø¥Ù† Ù‡Ø¯Ù‰ Ø§Ù„Ù„Ù‡ Ù‡Ùˆ Ø§Ù„Ù‡Ø¯Ù‰", "Ù‚Ù„ ÙŠØ§ Ø£ÙŠÙ‡Ø§ Ø§Ù„ÙƒØ§ÙØ±ÙˆÙ†", "Ù„Ø§ Ù„ÙƒÙ… Ù…Ø§ ÙƒÙØ±ØªÙ… ÙˆÙ„Ø§ Ù„ÙŠ Ù…Ø§ Ø¹Ø¨Ø¯ØªÙ…", "Ù„ÙƒÙ„ Ø¬Ø¹Ù„Ù†Ø§ Ø´Ø±Ø¹Ø© ÙˆÙ…Ù†Ù‡Ø§Ø¬Ø§", "Ù„Ø¹Ù„ÙƒÙ… ØªØªÙ‚ÙˆÙ†", "ÙˆØªØ¹Ø§ÙˆÙ†ÙˆØ§ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø± ÙˆØ§Ù„ØªÙ‚ÙˆÙ‰", "ÙˆØ§Ø¹ØªØµÙ…ÙˆØ§ Ø¨Ø­Ø¨Ù„ Ø§Ù„Ù„Ù‡ Ø¬Ù…ÙŠØ¹Ø§", "ÙˆÙ„Ø§ ØªÙ†Ø§Ø²Ø¹ÙˆØ§", "ÙˆØ§Ø°ÙƒØ±ÙˆØ§ Ù†Ø¹Ù…Ø© Ø§Ù„Ù„Ù‡ Ø¹Ù„ÙŠÙƒÙ…", "Ø¥Ø°Ø§ Ø¶Ø±Ø¨ØªÙ… ÙÙŠ Ø§Ù„Ø£Ø±Ø¶", "Ù…Ù† Ø£Ø­Ø³Ù† Ø¹Ù…Ù„Ø§", "ÙˆØ£Ø­Ø³Ù†ÙˆØ§ Ø¥Ù† Ø§Ù„Ù„Ù‡ ÙŠØ­Ø¨ Ø§Ù„Ù…Ø­Ø³Ù†ÙŠÙ†", "ÙˆÙ‚ÙˆÙ„ÙˆØ§ Ù„Ù„Ù†Ø§Ø³ Ø­Ø³Ù†Ø§", "ÙˆØ§ØªÙ‚ÙˆØ§ Ø§Ù„Ù„Ù‡ Ø§Ù„Ø°ÙŠ ØªØªØ³Ø§Ø¡Ù„ÙˆÙ† Ø¨Ù‡", "ÙˆØ£Ù‚Ø³Ù…ÙˆØ§ Ø¨Ø§Ù„Ù„Ù‡ Ø¬Ù‡Ø¯ Ø£ÙŠÙ…Ø§Ù†Ù‡Ù…", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ³Ø§Ø±Ø¹ÙˆÙ† ÙÙŠ Ø§Ù„Ø®ÙŠØ±Ø§Øª", "ÙˆÙƒØ§Ù†ÙˆØ§ Ù…Ù† Ø§Ù„Ù…ØµÙ„Ø­ÙŠÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ£Ù…Ø±ÙˆÙ† Ø¨Ø§Ù„Ù…Ø¹Ø±ÙˆÙ", "ÙˆÙŠÙ†Ù‡ÙˆÙ† Ø¹Ù† Ø§Ù„Ù…Ù†ÙƒØ±", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ­Ø§ÙØ¸ÙˆÙ† Ø¹Ù„Ù‰ Ø§Ù„ØµÙ„Ø§Ø©", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ¤ØªÙˆÙ† Ø§Ù„Ø²ÙƒØ§Ø©", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØµÙˆÙ…ÙˆÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠÙ‚Ø±Ø¡ÙˆÙ† Ø§Ù„Ù‚Ø±Ø¢Ù†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØªÙÙƒØ±ÙˆÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØªØ¯Ø¨Ø±ÙˆÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØªØ¹Ø¸ÙˆÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ²ÙƒÙˆÙ† Ø£Ù†ÙØ³Ù‡Ù…", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØªØ·Ù‡Ø±ÙˆÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ¨ØªØºÙˆÙ† Ù…Ø±Ø¶Ø§Øª Ø±Ø¨Ù‡Ù…", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ±Ø¬ÙˆÙ† Ø±Ø­Ù…Ø© Ø±Ø¨Ù‡Ù…", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ®Ø§ÙÙˆÙ† Ø¹Ø°Ø§Ø¨ Ø±Ø¨Ù‡Ù…", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ¯Ø¹ÙˆÙ† Ø±Ø­Ù…Ø©", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ³ØªØºÙØ±ÙˆÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠÙ‚Ø±Ø¡ÙˆÙ† Ø§Ù„Ø¢ÙŠØ§Øª", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ¤Ù…Ù†ÙˆÙ† Ø¨Ø§Ù„ØºÙŠØ¨", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠÙ‚ÙŠÙ…ÙˆÙ† Ø§Ù„ØµÙ„Ø§Ø©", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ¤ØªÙˆÙ† Ø§Ù„Ø²ÙƒØ§Ø©", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ£Ù…Ø±ÙˆÙ† Ø¨Ø§Ù„Ù…Ø¹Ø±ÙˆÙ", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠÙ†Ù‡ÙˆÙ† Ø¹Ù† Ø§Ù„Ù…Ù†ÙƒØ±", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØµØ¨Ø±ÙˆÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ù„Ø§Ø¡", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ´ÙƒØ±ÙˆÙ† ÙÙŠ Ø§Ù„Ø³Ø±Ø§Ø¡", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØµØ¨Ø±ÙˆÙ† ÙÙŠ Ø§Ù„Ø¶Ø±Ø§Ø¡", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØªÙˆÙƒÙ„ÙˆÙ† Ø¹Ù„Ù‰ Ø§Ù„Ù„Ù‡", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ«Ù‚ÙˆÙ† Ø¨ÙˆØ¹Ø¯Ù‡", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ­Ø¨ÙˆÙ† Ø§Ù„Ù„Ù‡", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ®Ø§ÙÙˆÙ†Ù‡", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ±Ø¬ÙˆÙ†Ù‡", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØªÙ‚ÙˆÙ†Ù‡", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ¹Ø¨Ø¯ÙˆÙ†Ù‡", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ°ÙƒØ±ÙˆÙ†Ù‡", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ´ÙƒØ±ÙˆÙ†Ù‡", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØµØ¨Ø±ÙˆÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØªÙˆÙƒÙ„ÙˆÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ¤Ù…Ù†ÙˆÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ¹Ù…Ù„ÙˆÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ­Ø³Ù†ÙˆÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ¹Ø¯Ù„ÙˆÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ±Ø­Ù…ÙˆÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØµÙØ­ÙˆÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ¹ÙÙˆÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØºÙØ±ÙˆÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠÙ†ØµØ­ÙˆÙ†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠÙ†ØµØ±ÙˆÙ† Ø§Ù„Ù…Ø¸Ù„ÙˆÙ…", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠÙˆÙ‚ÙÙˆÙ† Ø§Ù„Ø¸Ù„Ù…", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠÙ†ØµØªÙˆÙ† Ù„Ù„Ø¢Ø®Ø±", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ­ØªØ±Ù…ÙˆÙ† Ø§Ù„Ø§Ø®ØªÙ„Ø§Ù", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠÙ‚Ø¯Ø±ÙˆÙ† Ø§Ù„ØªÙ†ÙˆØ¹", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ¤Ù…Ù†ÙˆÙ† Ø¨Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ­ØªØ±Ù…ÙˆÙ† Ø§Ù„Ø¹Ù‚ÙŠØ¯Ø©", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ¤Ù…Ù†ÙˆÙ† Ø¨Ø§Ù„Ø­Ø±ÙŠØ©", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ¯Ø¹Ù…ÙˆÙ† Ø§Ù„ØªØ¹Ø§ÙŠØ´", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ¨Ù†ÙˆÙ† Ø§Ù„Ø¬Ø³ÙˆØ±", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØµÙ†Ø¹ÙˆÙ† Ø§Ù„Ø³Ù„Ø§Ù…", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ²Ø±Ø¹ÙˆÙ† Ø§Ù„Ù…Ø­Ø¨Ø©", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ¨Ø¯Ø¯ÙˆÙ† Ø§Ù„Ùƒarya", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠÙ‡Ø¯Ù…ÙˆÙ† Ø§Ù„Ø¬Ø¯Ø±Ø§Ù†", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠÙØªØ­ÙˆÙ† Ø§Ù„Ù‚Ù„ÙˆØ¨", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠÙ†Ø§Ø¯ÙˆÙ† Ø¨Ø§Ù„Ø¹Ø¯Ù„", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ¯Ø§ÙØ¹ÙˆÙ† Ø¹Ù† Ø§Ù„Ø­Ù‚ÙˆÙ‚", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠÙ†ØµØ±ÙˆÙ† Ø§Ù„Ø­Ù‚", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ­ÙØ¸ÙˆÙ† Ø§Ù„Ø¹Ù‡Ø¯", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠÙˆÙÙˆÙ† Ø¨Ø§Ù„ÙˆØ¹Ø¯", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠÙ‚ÙŠÙ…ÙˆÙ† Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø¨Ø§Ù„Ø­Ù‚", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠÙ†ØµØªÙˆÙ† Ù„Ù„Ø­Ø¬Ø©", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠÙ‚Ø¨Ù„ÙˆÙ† Ø§Ù„Ø­Ø¬Ø©", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ­ØªØ±Ù…ÙˆÙ† Ø§Ù„Ø±Ø£ÙŠ", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ®ØªÙ„ÙÙˆÙ† Ø¨Ø§Ø­ØªØ±Ø§Ù…", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØªØ­Ø§ÙˆØ±ÙˆÙ† Ø¨Ø¹Ù‚Ù„", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØªÙØ§Ù‡Ù…ÙˆÙ† Ø¨Ø±ÙˆØ­", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØªØ¹Ø§ÙˆÙ†ÙˆÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø®ÙŠØ±", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØªÙ†Ø§ØµØ­ÙˆÙ† Ø¨Ù„Ø·Ù", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ¯Ø¹ÙˆÙ† Ø¥Ù„Ù‰ Ø§Ù„Ø®ÙŠØ±", "ÙˆÙƒØ§Ù†ÙˆØ§ ÙŠØ±Ø´Ø¯ÙˆÙ† Ø¨Ø§Ù„Ø­ÙƒÙ…Ø©"
    ],
    "netral": [
        # Istilah objektif, akademik, kontekstual â€” >150 entri
        "Ø°ÙƒØ±", "Ù†Ù‚Ù„", "Ù‚Ø±Ø§Ø¡Ø©", "ØªØ­Ù„ÙŠÙ„", "ØªÙØ³ÙŠØ±", "ØªØ£ÙˆÙŠÙ„", "ØªÙÙƒØ±", "ØªØ¯Ø¨Ø±", "ØªØ¹Ù‚Ù„", "ØªØ£Ù…Ù„", "Ø¯Ø±Ø§Ø³Ø©", "Ø¨Ø­Ø«", "ØªØ­Ù‚ÙŠÙ‚", "Ø¹Ù„Ù…", "Ù…Ø¹Ø±ÙØ©", "ÙÙ‡Ù…", "Ø¥Ø¯Ø±Ø§Ùƒ", "ÙˆØ¹ÙŠ", "Ø¥Ø­ØµØ§Ø¡", "ØªØ³Ø¬ÙŠÙ„", "ÙˆØµÙ", "Ø¨ÙŠØ§Ù†", "Ø³ÙŠØ§Ù‚", "Ø²Ù…Ù†", "Ù…ÙƒØ§Ù†", "Ø¸Ø±ÙˆÙ", "ÙˆØ§Ù‚Ø¹", "Ø¸Ø§Ù‡Ø±Ø©", "Ø­Ø¯Ø«", "ÙˆØ§Ù‚Ø¹Ø©", "Ù‚ØµØ©", "Ø®Ø¨Ø±", "Ø­Ø¯ÙŠØ«", "Ø±ÙˆØ§ÙŠØ©", "Ø¥Ø³Ù†Ø§Ø¯", "Ù…ØªÙ†", "Ù†Øµ", "Ù„ÙØ¸", "Ù…Ø¹Ù†Ù‰", "Ø¯Ù„Ø§Ù„Ø§Øª", "Ù…Ù‚Ø§ØµØ¯", "Ø­ÙƒÙ…", "Ø¹Ù„Ø©", "Ø³Ø¨Ø¨", "ØºØ§ÙŠØ©", "Ù‡Ø¯Ù", "Ù…ØµÙ„Ø­Ø©", "Ø¶Ø§Ø¨Ø·", "Ù‚Ø§Ø¹Ø¯Ø©", "Ù…Ù†Ù‡Ø¬", "Ù†Ø¸Ø±ÙŠØ©", "Ù…Ø¯Ø±Ø³Ø©", "ÙØ±Ù‚Ø©", "Ø·Ø§Ø¦ÙØ©", "Ø¬Ù…Ø§Ø¹Ø©", "Ù…Ø¬ØªÙ…Ø¹", "Ø«Ù‚Ø§ÙØ©", "ØªÙ‚Ù„ÙŠØ¯", "Ø¹Ø±Ù", "Ø¹Ø§Ø¯Ø©", "Ø³ÙŠØ±Ø©", "ØªØ§Ø±ÙŠØ®", "ÙˆÙ‚Ø§Ø¦Ø¹", "ØªØ·ÙˆØ±", "ØªØºÙŠØ±", "ØªØ­ÙˆÙ„", "Ù…Ù‚Ø§Ø±Ù†Ø©", "å¯¹ç…§æ£€æŸ¥", "Ø§Ø³ØªÙ‚Ø±Ø§Ø¡", "Ù‚ÙŠØ§Ø³", "Ø§Ø³ØªÙ†Ø¨Ø§Ø·", "Ø§Ø¬ØªÙ‡Ø§Ø¯", "ØªÙ‚Ù„ÙŠØ¯", "ÙØªÙˆÙ‰", "Ø±Ø£ÙŠ", "Ø®Ù„Ø§Ù", "Ø§Ø®ØªÙ„Ø§Ù", "Ù…Ø¬Ø§Ø¯Ù„Ø©", "Ø¬Ø¯Ù„", "Ø­ÙˆØ§Ø± Ø¹Ù„Ù…ÙŠ", "Ù†Ù‚Ø§Ø´", "Ù…Ù†Ø§Ø¸Ø±Ø©", "Ø§Ø³ØªÙÙ‡Ø§Ù…", "Ø¬ÙˆØ§Ø¨", "Ø§Ø³ØªØ¯Ù„Ø§Ù„", "Ø¯Ù„ÙŠÙ„", "Ø¨Ø±Ù‡Ø§Ù†", "Ø­Ø¬Ø©", "Ø´Ø¨Ù‡Ø©", "Ø±Ø¯", "ØªÙˆØ¶ÙŠØ­", "ØªØµØ­ÙŠØ­", "ØªØµÙˆÙŠØ¨", "ØªÙ…ÙŠÙŠØ²", "ÙØµÙ„", "ØªØµÙ†ÙŠÙ", "ØªØ±ØªÙŠØ¨", "ØªÙ‚Ø³ÙŠÙ…", "ØªÙ…Ø«ÙŠÙ„", "Ø³Ø±Ø¯", "Ø¹Ø±Ø¶", "Ø´Ø±Ø­", "ØªÙˆØ¶ÙŠØ­", "ØªÙØµÙŠÙ„", "Ø¥Ø¬Ù…Ø§Ù„", "Ø¥ÙŠØ¬Ø§Ø²", "Ø¥Ø·Ù†Ø§Ø¨", "Ø¨Ù„Ø§ØºØ©", "ÙØµØ§Ø­Ø©", "Ø¨ÙŠØ§Ù†", "Ø¥Ø¹Ø±Ø§Ø¨", "Ù„ØºØ©", "Ù…ØµØ·Ù„Ø­", "Ù…ØµØ·Ù„Ø­Ø§Øª Ø´Ø±Ø¹ÙŠØ©", "Ù…ØµØ·Ù„Ø­Ø§Øª ÙÙ‚Ù‡ÙŠØ©", "Ù…ØµØ·Ù„Ø­Ø§Øª ØªÙØ³ÙŠØ±ÙŠØ©", "Ù…ØµØ·Ù„Ø­Ø§Øª Ø¹Ù‚Ø¯ÙŠØ©"
    ],
    "intoleran": [
        # Istilah yang menunjukkan penolakan, kekerasan, ekstremisme â€” >150 entri
        "ÙƒÙØ±", "Ø´Ø±Ùƒ", "Ù†ÙØ§Ù‚", "Ù…Ø±ÙˆÙ‚", "Ø®Ø±ÙˆØ¬", "Ø¨ØºÙ‰", "Ø¹ØªØ¯", "Ø¸Ù„Ù…", "Ø¹Ø¯ÙˆØ§Ù†", "Ù‚ØªÙ„", "Ù‚ØªØ§Ù„", "Ø­Ø±Ø¨", "Ù‡Ø¬ÙˆÙ…", "ØºØ²Ùˆ", "ØªØ¯Ù…ÙŠØ±", "ØªØ®Ø±ÙŠØ¨", "Ø­Ø±Ù‚", "Ù†Ù‡Ø¨", "Ø³Ù„Ø¨", "Ø§ØºØªØµØ§Ø¨", "Ø§Ø³ØªØ¹Ø¨Ø§Ø¯", "Ø§Ø³ØªØ±Ù‚Ø§Ù‚", "Ø¥Ø±Ù‡Ø§Ø¨", "ØªØ±ÙˆÙŠØ¹", "ØªÙ‡Ø¯ÙŠØ¯", "ØªØ®ÙˆÙŠÙ", "Ø¥ÙƒØ±Ø§Ù‡", "Ø¥Ø¬Ø¨Ø§Ø±", "Ø¥Ø±ØºØ§Ù…", "ØªØ¹Ø°ÙŠØ¨", "ØªØ´Ø±ÙŠØ¯", "ØªÙ‡Ø¬ÙŠØ±", "Ø¥Ù‚ØµØ§Ø¡", "Ø§Ø³ØªØ¦ØµØ§Ù„", "ØªÙ‚ØªÙŠÙ„", "Ø°Ø¨Ø­", "ØµÙ„Ø¨", " crucifixion", "ØªØ¹Ø²ÙŠØ±", "ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯", "ØªØ¬Ø§ÙˆØ² Ø§Ù„Ù†ØµØ§Ø¨", "Ø³ÙÙƒ Ø§Ù„Ø¯Ù…Ø§Ø¡", "Ù‡Ø¯Ø± Ø§Ù„Ø¯Ù…", "ØªÙƒÙÙŠØ±", "ØªØ¬Ø±ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¥Ù†Ø³Ø§Ù†ÙŠØ©", "ØªØ­Ø±ÙŠÙ… Ø§Ù„Ø¯Ù…", "ØªØ¨Ø¯ÙŠØ¹", "ØªÙØ³ÙŠÙ‚", "ØªØ­Ø±ÙŠÙ…", "ØªØ­Ø±ÙŠÙ… Ø§Ù„Ù…Ø°Ø§Ù‡Ø¨", "ØªØ¯Ù…ÙŠØ± Ø§Ù„Ù…Ù‚Ø¯Ø³Ø§Øª", "Ù‡Ø¯Ù… Ø§Ù„ÙƒÙ†Ø§Ø¦Ø³", "Ù‡Ø¯Ù… Ø§Ù„Ù…Ø¹Ø§Ø¨Ø¯", "Ù‡Ø¯Ù… Ø§Ù„Ù‚Ø¨ÙˆØ±", "Ù‡Ø¯Ù… Ø§Ù„Ù…Ø²Ø§Ø±Ø§Øª", "Ø´ØªÙ…", "Ø³Ø¨", "Ù„Ø¹Ù†", "Ø´ØªÙŠÙ…Ø©", "ØªØ­Ù‚ÙŠØ±", "Ø§Ø³ØªÙ‡Ø²Ø§Ø¡", "Ø§Ø³ØªÙ‡Ø§Ù†Ø©", "Ø§Ø³ØªØ®ÙØ§Ù", "Ø§Ø³ØªÙƒØ¨Ø§Ø±", "ØºØ±ÙˆØ±", "ØªÙƒØ¨Ø±", "Ø¹Ø¬Ø±ÙØ©", "ÙƒØ¨Ø±ÙŠØ§Ø¡", "Ø­Ù‚Ø¯", "Ø­Ø³Ø¯", "ØºÙ„", "Ø¹Ø¯Ø§ÙˆØ©", "Ø¨ØºØ¶Ø§Ø¡", "Ø´Ø­Ù†Ø§Ø¡", "ÙƒØ±Ø§Ù‡ÙŠØ©", "Ø­Ù‚Ø¯ Ø¯ÙÙŠÙ†", "Ø¹Ø¯ÙˆØ§Ù†ÙŠØ©", "Ø§Ù†ØºÙ„Ø§Ù‚", "Ø¹Ø²Ù„Ø©", "Ø§Ù†ÙØµØ§Ù„", "Ø§Ù†Ø¹Ø²Ø§Ù„ÙŠØ©", "Ø±ÙØ¶ Ø§Ù„Ø¢Ø®Ø±", "Ù†ÙÙŠ Ø§Ù„Ø¢Ø®Ø±", "ØªØ¬Ø±ÙŠØ¯", "ØªÙ‡Ù…ÙŠØ´", "ØªÙ…ÙŠÙŠØ²", "ØªÙ…ÙŠÙŠØ² Ø¯ÙŠÙ†ÙŠ", "ØªÙÙˆÙ‚ Ø¹Ù‚Ø§Ø¦Ø¯ÙŠ", "Ø¥Ù‚ØµØ§Ø¡ ÙÙƒØ±ÙŠ", "Ø­Ø¸Ø± Ø±Ø£ÙŠ", "Ù…Ù†Ø¹ ÙƒØªØ§Ø¨", "Ù…ØµØ§Ø¯Ø±Ø© ÙÙƒØ±", "Ù‚Ù…Ø¹ Ø­Ø±ÙŠØ©", "Ù‚Ù…Ø¹ Ø±Ø£ÙŠ", "Ù‚Ù…Ø¹ Ø¯ÙŠÙ†ÙŠ", "ØªØ­Ø±ÙŠØ¶", "ØªØ­Ø±ÙŠØ¶ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ù", "ØªØ­Ø±ÙŠØ¶ Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ±Ø§Ù‡ÙŠØ©", "Ø®Ø·Ø§Ø¨ ÙƒØ±Ø§Ù‡ia", "Ø®Ø·Ø§Ø¨ ØªÙ…ÙŠÙŠØ²ÙŠ", "Ø®Ø·Ø§Ø¨ Ø§Ø³ØªØ¹Ù„Ø§Ø¦ÙŠ", "Ø²Ø¹Ù… Ø§Ù„Ù‚Ø¯Ø§Ø³Ø©", "Ø§Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ø­ØµØ±ÙŠØ©", "Ø§Ø¯Ø¹Ø§Ø¡ Ø§Ù„ÙˆØµØ§ÙŠØ©", "Ø§Ø¯Ø¹Ø§Ø¡ Ù†ÙŠØ§Ø¨Ø© Ø§Ù„Ø¯ÙŠÙ†", "ÙØ±Ø¶ ÙÙ‡Ù…", "ØªÙƒÙ…ÙŠÙ… Ø§Ù„Ø£ÙÙˆØ§Ù‡", "Ø¥Ø³ÙƒØ§Øª Ø§Ù„Ù…Ø®Ø§Ù„Ù", "ØªØµÙÙŠØ© Ø¬Ø³Ø¯ÙŠØ©", "Ø§ØºØªÙŠØ§Ù„", "Ø§ØºØªÙŠØ§Ù„ Ø±Ù…Ø²ÙŠ", "ØªØ´ÙˆÙŠÙ‡ Ø§Ù„Ø³Ù…Ø¹Ø©", "ÙØ¶Ø­", "ØªØ¬Ø±ÙŠØ­", "Ø§ØªÙ‡Ø§Ù… Ø¨Ø§Ø·Ù„", "Ø§ÙØªØ±Ø§Ø¡", "Ø¨Ù‡ØªØ§Ù†", "ØºØ´", "Ø®Ø¯Ø§Ø¹", "ØªØ¯Ù„ÙŠØ³", "ØªØ²ÙŠÙŠÙ", "ØªØ²ÙˆÙŠØ±", "ØªÙ„Ø§Ø¹Ø¨ Ø¨Ø§Ù„Ù†ØµÙˆØµ", "ØªØ£ÙˆÙŠÙ„ Ø¨Ø§Ø·Ù„", "Ø§Ø³ØªØ¯Ù„Ø§Ù„ ÙØ§Ø³Ø¯", "Ø§Ø³ØªØ´Ù‡Ø§Ø¯ Ù…Ø¨ØªÙˆØ±", "Ø§Ù‚ØªØ·Ø§Ø¹ Ø¢ÙŠØ© Ù…Ù† Ø³ÙŠØ§Ù‚Ù‡Ø§", "Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¯ÙŠÙ† Ù„Ù„Ø³Ù„Ø·Ø©", "Ø§Ø³ØªØºÙ„Ø§Ù„ Ø§Ù„Ø¯ÙŠÙ†", "Ù…ØµØ§Ø¯Ø±Ø© Ø§Ù„Ù„Ù‡", "Ø§Ø¯Ø¹Ø§Ø¡ Ù…Ø¹Ø±ÙØ© Ø§Ù„ØºÙŠØ¨", "ÙØªÙˆÙ‰ Ø¨Ø§Ù„Ø¯Ù…", "Ø­ÙƒÙ… Ø¨Ø§Ù„Ø¥Ø¹Ø¯Ø§Ù…", "Ø¥Ø¨Ø§Ø­Ø© Ø§Ù„Ø¯Ù…", "Ø¥Ø¨Ø§Ø­Ø© Ø§Ù„Ù…Ø§Ù„", "Ø¥Ø¨Ø§Ø­Ø© Ø§Ù„Ø¹Ø±Ø¶"
    ]
}

ayat_dict = {
    "Ù„Ø§ Ø§ÙƒØ±Ø§Ù‡": ["QS. Al-Baqarah:256 'Ù„Ø§ Ø¥ÙƒØ±Ø§Ù‡ ÙÙŠ Ø§Ù„Ø¯ÙŠÙ† Ù‚Ø¯ ØªØ¨ÙŠÙ† Ø§Ù„Ø±Ø´Ø¯ Ù…Ù† Ø§Ù„ØºÙŠ'"],
    "Ù„ÙƒÙ… Ø¯ÙŠÙ†ÙƒÙ… ÙˆÙ„ÙŠ Ø¯ÙŠÙ†": ["QS. Al-Kafirun:6 'Ù„ÙƒÙ… Ø¯ÙŠÙ†ÙƒÙ… ÙˆÙ„ÙŠ Ø¯ÙŠÙ†'"],
    "Ø§Ù„Ù†Ø§Ø³": ["QS. Al-Hujurat:13 'ÙŠØ§ Ø£ÙŠÙ‡Ø§ Ø§Ù„Ù†Ø§Ø³ Ø¥Ù†Ø§ Ø®Ù„Ù‚Ù†Ø§ÙƒÙ… Ù…Ù† Ø°ÙƒØ± ÙˆØ£Ù†Ø«Ù‰...'"],
    "Ù„Ø§ ÙŠÙ†Ù‡Ø§ÙƒÙ…": ["QS. Al-Mumtahanah:8 'Ù„Ø§ ÙŠÙ†Ù‡Ø§ÙƒÙ… Ø§Ù„Ù„Ù‡ Ø¹Ù† Ø§Ù„Ø°ÙŠÙ† Ù„Ù… ÙŠÙ‚Ø§ØªÙ„ÙˆÙƒÙ…...'"],
    "ØªØ¬Ø§Ø¯Ù„ÙˆØ§": ["QS. Al-Ankabut:46 'ÙˆÙ„Ø§ ØªØ¬Ø§Ø¯Ù„ÙˆØ§ Ø£Ù‡Ù„ Ø§Ù„ÙƒØªØ§Ø¨ Ø¥Ù„Ø§ Ø¨Ø§Ù„ØªÙŠ Ù‡ÙŠ Ø£Ø­Ø³Ù†'"],
    "Ù…Ø§ Ø£Ù†Øª Ø¹Ù„ÙŠÙ‡Ù… Ø¨Ù…Ø¶Ø·Ø±": ["QS. Al-Ghashiyah:22 'Ù…Ø§ Ø£Ù†Øª Ø¹Ù„ÙŠÙ‡Ù… Ø¨Ù…Ø¶Ø·Ø±'"],
    "ÙˆÙ„Ùˆ Ø´Ø§Ø¡ Ø±Ø¨Ùƒ": ["QS. Yunus:99 'ÙˆÙ„Ùˆ Ø´Ø§Ø¡ Ø±Ø¨Ùƒ Ù„Ø¢Ù…Ù† Ù…Ù† ÙÙŠ Ø§Ù„Ø£Ø±Ø¶ ÙƒÙ„Ù‡Ù… Ø¬Ù…ÙŠØ¹Ø§Ù‹'"],
    "ÙˆÙ„Ø§ ØªØ³Ø¨ÙˆØ§": ["QS. Al-An'am:108 'ÙˆÙ„Ø§ ØªØ³Ø¨ÙˆØ§ Ø§Ù„Ø°ÙŠÙ† ÙŠØ¯Ø¹ÙˆÙ† Ù…Ù† Ø¯ÙˆÙ† Ø§Ù„Ù„Ù‡'"]
}

# 7) Visual util
def fig_to_image(fig):
    buf = BytesIO()
    fig.savefig(buf, format="png", bbox_inches="tight")
    plt.close(fig)
    buf.seek(0)
    return Image.open(buf).convert("RGB")

def make_bar_image(counts: pd.Series, title: str = "Distribusi"):
    fig, ax = plt.subplots(figsize=(6,4))
    idx = counts.index.tolist()
    vals = counts.values.tolist()
    ax.bar(idx, vals)
    ax.set_title(title)
    for i, v in enumerate(vals):
        ax.text(i, v + max(vals)*0.02 if vals else 0.05, str(v), ha='center', fontsize=9)
    return fig_to_image(fig)

def make_confusion_matrix_image(y_true, y_pred, labels=("Toleran","Netral","Intoleran"), title="Confusion Matrix"):
    cm = confusion_matrix(y_true, y_pred, labels=list(labels))
    fig, ax = plt.subplots(figsize=(5,4))
    im = ax.imshow(cm, interpolation='nearest', cmap='Blues')
    ax.figure.colorbar(im, ax=ax)
    ax.set(xticks=np.arange(cm.shape[1]), yticks=np.arange(cm.shape[0]),
           xticklabels=labels, yticklabels=labels, title=title, ylabel='Gold', xlabel='Pred')
    thresh = cm.max()/2 if cm.size>0 else 0.5
    for i in range(cm.shape[0]):
        for j in range(cm.shape[1]):
            ax.text(j, i, format(cm[i, j], 'd'), ha="center", va="center",
                    color="white" if cm[i, j] > thresh else "black")
    fig.tight_layout()
    return fig_to_image(fig)

# 8) Mapping & Ensemble
def softmax_scores_from_pipeline(pipe, text):
    try:
        out = pipe(text, truncation=True, max_length=512, return_all_scores=True)
        return out[0] if isinstance(out, list) else out
    except Exception:
        return [{"label":"neutral","score":0.5}]

def normalize_label(lab: str) -> str:
    return lab.strip().lower()

def map_arabert_to_three(vec):
    three = {"positive": 0.0, "negative": 0.0, "neutral": 0.0}
    for item in vec:
        lab = normalize_label(item.get("label",""))
        sc = float(item.get("score",0.0) or 0.0)
        if "pos" in lab:
            three["positive"] += sc
        elif "neg" in lab:
            three["negative"] += sc
        elif "neutral" in lab or "mixed" in lab:
            three["neutral"] += sc
    s = sum(three.values()) or 1.0
    return {k: v/s for k, v in three.items()}

def map_camel_to_three(vec):
    tmp = {}
    for item in vec:
        lab = normalize_label(item.get("label",""))
        sc = float(item.get("score",0.0) or 0.0)
        tmp[lab] = sc
    pos = tmp.get("1", tmp.get("positive", 0.0))
    neg = tmp.get("0", tmp.get("negative", 0.0))
    neu = tmp.get("neutral", None)
    if neu is None:
        margin = abs(pos - neg)
        if margin < 0.15:
            neu = (0.15 - margin)
            pos *= (1 - neu/2)
            neg *= (1 - neu/2)
        else:
            neu = 0.0
    total = max(pos + neg + neu, 1e-6)
    return {"positive": pos/total, "negative": neg/total, "neutral": neu/total}

def ensemble_three(p1: dict, p2: dict):
    keys = ["positive","negative","neutral"]
    ens = {k: 0.5*p1.get(k,0) + 0.5*p2.get(k,0) for k in keys}
    s = sum(ens.values()) or 1.0
    return {k: v/s for k, v in ens.items()}

def probs_to_label(probs: dict):
    lab = max(probs, key=probs.get)
    mapping = {"positive":"Toleran", "neutral":"Netral", "negative":"Intoleran"}
    return mapping.get(lab, "Netral"), probs[lab]

# 9) Rule-based fallback
def rule_based_probs(text_clean: str):
    pos_hits = sum(text_clean.count(p) for p in toleransi_phrases.get("toleran", []))
    neg_hits = sum(text_clean.count(p) for p in toleransi_phrases.get("intoleran", []))
    neu_hits = sum(text_clean.count(p) for p in toleransi_phrases.get("netral", []))
    total = pos_hits + neg_hits + neu_hits
    if total == 0:
        return {"positive":0.2,"neutral":0.6,"negative":0.2}
    return {
        "positive": pos_hits/total,
        "neutral": neu_hits/total,
        "negative": neg_hits/total
    }

# 10) Analisis Hermeneutik (DIPERKAYA + PERBAIKAN)
def analyze_hermeneutics_enhanced(text: str, all_texts: list):
    results = {"intertextual": [], "historical": [], "philosophical": [], "semantic_similarity": [], "topic_modeling": []}
    # 1. Intertekstual
    for keyword, data in INTERTEXTUAL_DB.items():
        if keyword in text:
            results["intertextual"].append({
                "keyword": keyword,
                "related_verses": data["related_verses"],
                "theme": data["theme"],
                "explanation": data["explanation"]
            })
    # 2. Historis
    for term, context in HISTORICAL_CONTEXT_DB.items():
        if term in text:
            results["historical"].append({
                "term": term,
                "context": context["context"],
                "significance": context["significance"]
            })
    # 3. Filosofis-Teologis
    for concept, data in PHILOSOPHICAL_CONCEPTS.items():
        if concept in text:
            results["philosophical"].append({
                "concept": concept,
                "explanation": data["concept"],
                "theological_basis": data["theological_basis"]
            })
    # 4. Semantic Similarity (dengan fallback)
    if sbert_loaded:
        try:
            clean_text = normalize_arabic(text)
            current_emb = sbert_model.encode([clean_text])
            all_embs = [sbert_model.encode([normalize_arabic(t)])[0] for t in all_texts]
            all_embs = np.vstack(all_embs)
            sims = cosine_similarity(current_emb, all_embs)[0]
            top_indices = sims.argsort()[-5:][::-1]
            for idx in top_indices:
                if sims[idx] > 0.4:
                    results["semantic_similarity"].append({
                        "text": all_texts[idx][:100] + "...",
                        "similarity": float(sims[idx])
                    })
        except Exception as e:
            results["semantic_similarity"].append({"error": f"SBERT error: {str(e)}"})
    else:
        results["semantic_similarity"].append({"error": "SBERT tidak tersedia."})
    # 5. Topic Modeling (LDA)
    try:
        words = [w for w in re.findall(r'[\u0600-\u06FF]+', normalize_arabic(text)) if len(w) > 2]
        if len(words) > 5:
            try:
                dictionary = corpora.Dictionary([words])
                if len(dictionary) < 2:
                    results["topic_modeling"].append({"warning": "Kosakata terlalu sedikit untuk LDA."})
                else:
                    corpus = [dictionary.doc2bow(words)]
                    lda_model = LdaModel(corpus, num_topics=2, id2word=dictionary, passes=10, random_state=42)
                    topics = lda_model.print_topics(num_words=5)
                    for topic in topics:
                        results["topic_modeling"].append({
                            "topic_id": topic[0],
                            "keywords": topic[1]
                        })
            except Exception as e:
                results["topic_modeling"].append({"error": f"LDA internal error: {str(e)}"})
        else:
            results["topic_modeling"].append({"warning": "Teks terlalu pendek untuk LDA."})
    except Exception as e:
        results["topic_modeling"].append({"error": f"LDA error: {str(e)}"})
    return results

def format_hermeneutics_results_enhanced(hermeneutics):
    if not any(hermeneutics.values()):
        return "Tidak ditemukan analisis hermeneutik yang signifikan."
    output = ""
    if hermeneutics.get("intertextual"):
        output += "ğŸ“– **ANALISIS INTERTEKSTUAL:**\n"
        for item in hermeneutics["intertextual"]:
            output += f"â€¢ **{item['keyword']}**: {item['explanation']}\n"
    if hermeneutics.get("historical"):
        output += "ğŸº **KONTEKS HISTORIS:**\n"
        for item in hermeneutics["historical"]:
            output += f"â€¢ **{item['term']}**: {item['context']}\n"
    if hermeneutics.get("philosophical"):
        output += "ğŸ§  **KONSEP FILOSOFIS-TEOLOGIS:**\n"
        for item in hermeneutics["philosophical"]:
            output += f"â€¢ **{item['concept']}**: {item['explanation']}\n"
    if hermeneutics.get("semantic_similarity"):
        output += "ğŸ”— **KEMIRIPAN SEMANTIK (SBERT):**\n"
        for item in hermeneutics["semantic_similarity"]:
            if "error" in item:
                output += f"âš ï¸ {item['error']}\n"
            else:
                output += f"â€¢ **Sim={item['similarity']:.3f}**: {item['text']}\n"
    if hermeneutics.get("topic_modeling"):
        output += "ğŸ“Š **TOPIC MODELING (LDA):**\n"
        for item in hermeneutics["topic_modeling"]:
            if "error" in item or "warning" in item:
                output += f"âš ï¸ {item.get('error', item.get('warning'))}\n"
            else:
                output += f"â€¢ Topic {item['topic_id']}: {item['keywords']}\n"
    return output

# 11) Prediksi per teks
def predict_sentiment(clean_text: str, mode: str):
    for phrase, context in SENSITIVE_VERSES.items():
        if phrase in clean_text:
            return context["override_sentiment"], f"Rule-Based Override ({phrase})"
    if not arabert_loaded and not camel_loaded:
        return rule_based_probs(clean_text), "Rule-based Fallback"
    if mode == "AraBERT only" and arabert_loaded:
        v_ar = softmax_scores_from_pipeline(pipe_arabert, clean_text)
        return map_arabert_to_three(v_ar), "AraBERT"
    elif mode == "CAMeLBERT only" and camel_loaded:
        v_cm = softmax_scores_from_pipeline(pipe_camel, clean_text)
        return map_camel_to_three(v_cm), "CAMeLBERT"
    else:
        if arabert_loaded and camel_loaded:
            v_ar = map_arabert_to_three(softmax_scores_from_pipeline(pipe_arabert, clean_text))
            v_cm = map_camel_to_three(softmax_scores_from_pipeline(pipe_camel, clean_text))
            return ensemble_three(v_ar, v_cm), "Ensemble"
        elif arabert_loaded:
            v_ar = map_arabert_to_three(softmax_scores_from_pipeline(pipe_arabert, clean_text))
            return v_ar, "AraBERT (fallback)"
        elif camel_loaded:
            v_cm = map_camel_to_three(softmax_scores_from_pipeline(pipe_camel, clean_text))
            return v_cm, "CAMeLBERT (fallback)"
        else:
            return rule_based_probs(clean_text), "Rule-based Fallback"

# 12) Analisis teks utama
def analyze_text(input_text: str, mode: str):
    if not input_text or len(input_text.strip()) < 3:
        df_empty = pd.DataFrame({"Kata": [], "Kategori": []})
        img_empty = make_bar_image(pd.Series([1], index=["Tidak ada"]), "Tidak ada data")
        return "Input tidak valid.", df_empty, "Input kosong.", "Toleran: -", "Maqashid: -", "Ayat: -", "âš ï¸ Tidak ada", img_empty, None, pd.DataFrame(), "Tidak ada analisis hermeneutik"
    try:
        clean_text = normalize_arabic(input_text)
        probs, used = predict_sentiment(clean_text, mode)
        label, conf = probs_to_label(probs)
        score = round(conf, 3)
        maqashid_detected = set()
        toleransi_detected = {"toleran": [], "netral": [], "intoleran": []}
        ayat_detected = []
        warning_text = "Tidak ada peringatan."
        hermeneutic_analysis = ""

        # deteksi frasa
        for cat, phrases in toleransi_phrases.items():
            for phrase in phrases:
                if phrase in clean_text:
                    toleransi_detected[cat].append(phrase)
                    if phrase in ayat_dict:
                        ayat_detected.extend(ayat_dict[phrase])

        # SENSITIVE VERSES -> detail context (pakai triple-quoted f-strings)
        for phrase, context in SENSITIVE_VERSES.items():
            if phrase in clean_text:
                warning_text = f"""âš ï¸ {context.get('warning','')}
ğŸ“Œ **Konteks:**
{context.get('context','-')}"""
                if "intertextual" in context:
                    warning_text += f"""\nğŸ“– **Hubungan Intertekstual:**
{context['intertextual'].get('explanation','-')}"""
                if "historical_context" in context:
                    warning_text += f"""\nğŸº **Konteks Historis:**
{context.get('historical_context','-')}"""
                if "philosophical_theological" in context:
                    warning_text += f"""\nğŸ§  **Nuansa Filosofis-Teologis:**
{context.get('philosophical_theological','-')}"""
                for maq in context.get("maqashid", []):
                    maqashid_detected.add(maq)
                break

        # koleksi semua teks tafsir untuk analisis semantik
        all_texts = [item["text"] for item in tafsir_data]
        hermeneutics = analyze_hermeneutics_enhanced(clean_text, all_texts)
        hermeneutic_analysis = format_hermeneutics_results_enhanced(hermeneutics)

        # maqashid dari kata-kata
        words = re.findall(r'[\u0600-\u06FF]+', clean_text)
        for word in words:
            for maq, kws in maqashid_map.items():
                if any(kw in word for kw in kws):
                    maqashid_detected.add(maq)

        # highlighting frasa
        highlighted = clean_text
        for w in sorted(set(toleransi_detected["intoleran"]), key=len, reverse=True):
            highlighted = highlighted.replace(w, f" [INT:{w}] ")
        for w in sorted(set(toleransi_detected["toleran"]), key=len, reverse=True):
            highlighted = highlighted.replace(w, f" [TOL:{w}] ")

        # tabel kata
        data = []
        for w in words:
            if any(p in w for p in toleransi_detected["toleran"]):
                cat = "Toleran"
            elif any(p in w for p in toleransi_detected["intoleran"]):
                cat = "Intoleran"
            elif any(p in w for p in toleransi_detected["netral"]):
                cat = "Netral"
            else:
                cat = "Lainnya"
            data.append({"Kata": w, "Kategori": cat})
        df = pd.DataFrame(data)
        counts = df["Kategori"].value_counts() if not df.empty else pd.Series(dtype=int)
        for cat in ["Toleran","Netral","Intoleran","Lainnya"]:
            if cat not in counts:
                counts.loc[cat] = 0
        counts = counts.loc[["Toleran","Netral","Intoleran","Lainnya"]]
        img_dist = make_bar_image(counts, "Distribusi Kategori")

        # analisis per kalimat
        sents = ar_sentence_split(clean_text)
        sent_res = []
        for s in sents:
            p, u = predict_sentiment(s, mode)
            lab, cf = probs_to_label(p)
            sent_res.append({"Kalimat": s, "Label": lab, "P(+)": round(p["positive"],3), "P(0)": round(p["neutral"],3), "P(-)": round(p["negative"],3)})
        df_sent = pd.DataFrame(sent_res) if sent_res else pd.DataFrame(columns=["Kalimat","Label","P(+)","P(0)","P(-)"])
        if not df_sent.empty:
            counts_sent = df_sent["Label"].value_counts()
            for cat in ["Toleran","Netral","Intoleran"]:
                if cat not in counts_sent:
                    counts_sent.loc[cat] = 0
            counts_sent = counts_sent.loc[["Toleran","Netral","Intoleran"]]
            img_sent = make_bar_image(counts_sent, "Distribusi Sentimen per Kalimat")
        else:
            img_sent = None

        # KWIC
        kw_all = list(set(toleransi_phrases.get("toleran", []) + toleransi_phrases.get("intoleran", [])))
        kwic_rows = []
        for kw in kw_all:
            for m in re.finditer(re.escape(kw), clean_text):
                start = max(m.start()-25, 0)
                end = min(m.end()+25, len(clean_text))
                ctx = clean_text[start:end]
                kwic_rows.append({"Keyword": kw, "KWIC": ctx})
        df_kwic = pd.DataFrame(kwic_rows) if kwic_rows else pd.DataFrame(columns=["Keyword","KWIC"])

        stats = (
            f"Model: {used}\n"
            f"Dokumen Sentimen: {label} (confidence={score})\n"
            f"P(+)={probs['positive']:.3f} | P(-)={probs['negative']:.3f} | P(0)={probs['neutral']:.3f}\n"
            f"Frasa: Toleran={len(toleransi_detected['toleran'])}, Intoleran={len(toleransi_detected['intoleran'])}\n"
            f"Kalimat dianalisis: {len(sents)}"
        )
        ctx = f"Toleran: {', '.join(sorted(set(toleransi_detected['toleran']))) or '-'}"
        maq = f"Maqashid: {', '.join(sorted(maqashid_detected)) or '-'}"
        ayat = "\n".join(sorted(set(ayat_detected))) or "-"

        return highlighted, df, stats, ctx, maq, ayat, warning_text, img_dist, img_sent, df_kwic, hermeneutic_analysis

    except Exception as e:
        df_err = pd.DataFrame({"Kata": [], "Kategori": []})
        img_err = make_bar_image(pd.Series([1], index=["Error"]), "Error")
        return f"Error: {e}", df_err, "Error.", "-", "-", "-", "âš ï¸ Error", img_err, None, pd.DataFrame(), "Error dalam analisis hermeneutik"

# 13) Evaluasi CSV
def evaluate_csv(file_obj, mode: str):
    try:
        df = pd.read_csv(file_obj.name) if hasattr(file_obj, "name") else pd.read_csv(file_obj)
    except Exception:
        df = pd.read_excel(file_obj.name) if hasattr(file_obj, "name") else pd.read_excel(file_obj)
    if "text" not in df.columns or "gold" not in df.columns:
        raise ValueError("CSV harus memiliki kolom: 'text' dan 'gold'.")
    preds = []
    probs_list = []
    for txt in df["text"].astype(str).tolist():
        clean = normalize_arabic(txt)
        probs, used = predict_sentiment(clean, mode)
        preds.append(probs_to_label(probs)[0])
        probs_list.append(probs)
    labels = ["Toleran","Netral","Intoleran"]
    y_true = df["gold"].astype(str).str.strip().map(lambda x: x.capitalize())
    y_pred = pd.Series(preds)
    acc = accuracy_score(y_true, y_pred)
    pr, rc, f1, support = precision_recall_fscore_support(y_true, y_pred, labels=labels, zero_division=0)
    report = classification_report(y_true, y_pred, labels=labels, zero_division=0)
    cm_img = make_confusion_matrix_image(y_true, y_pred, labels=labels, title=f"CM - {mode}")
    out_df = df.copy()
    out_df["pred"] = y_pred
    out_df["P(+)"] = [round(p["positive"],4) for p in probs_list]
    out_df["P(0)"] = [round(p["neutral"],4) for p in probs_list]
    out_df["P(-)"] = [round(p["negative"],4) for p in probs_list]
    out_path = "hasil_prediksi.csv"
    out_df.to_csv(out_path, index=False)
    summary = (
        f"Mode: {mode}\n"
        f"Accuracy: {acc:.4f}\n"
        f"Precision (Toleran/Netral/Intoleran): {pr}\n"
        f"Recall    (Toleran/Netral/Intoleran): {rc}\n"
        f"F1        (Toleran/Netral/Intoleran): {f1}\n"
        f"Support   (Toleran/Netral/Intoleran): {support}\n"
        f"Classification Report:\n{report}"
    )
    return summary, cm_img, out_path

# 14) DATASET ASLI: TAFSIR AL-QURTHUBI & AZ-ZUHAILI â€” 6 AYAT TOLERANSI (DIPERBARUI)
tafsir_data = [
    {
        "source": "al-Qurthubi,Al-Jamiâ€™ li Ahkam al-Qurâ€™an, Juz 2, hlm. 216",
        "surah": "Ø§Ù„Ø¨Ù‚Ø±Ø©",
        "ayah": "256",
        "reference": "2:256",
        "theme": "Ù„Ø§ Ø¥ÙƒØ±Ø§Ù‡ ÙÙŠ Ø§Ù„Ø¯ÙŠÙ†",
        "text": "Ù‡ÙØ°ÙÙ‡Ù Ø§Ù„Ù’Ø¢ÙŠÙØ©Ù Ù…ÙÙ†Ù’ Ø£ÙÙˆÙ’ÙƒÙØ¯Ù Ø§Ù„Ù’Ø£ÙØ¯ÙÙ„ÙÙ‘Ø©Ù Ø¹ÙÙ„ÙÙ‰ Ø£ÙÙ†ÙÙ‘ Ø§Ù„Ø¯ÙÙ‘Ø¹Ù’ÙˆÙØ©Ù Ø¥ÙÙ„ÙÙ‰ Ø§Ù„Ù„ÙÙ‘Ù‡Ù ØªÙÙƒÙÙˆÙ†Ù Ø¨ÙØ§Ù„Ù’Ø­ÙØ¬ÙÙ‘Ø©Ù ÙˆÙØ§Ù„Ù’Ø¨ÙÙŠÙÙ‘Ù†ÙØ©ÙØŒ Ù„ÙØ§ Ø¨ÙØ§Ù„Ù’Ø¥ÙÙƒÙ’Ø±ÙØ§Ù‡Ù. ÙˆÙÙ‚ÙØ¯Ù’ Ù†ÙØ²ÙÙ„ÙØªÙ’ ÙÙÙŠ Ø±ÙØ¬ÙÙ„Ù Ù…ÙÙ†Ù Ø§Ù„Ù’Ø£ÙÙ†Ù’ØµÙØ§Ø±Ù Ø£ÙØ³Ù’Ù„ÙÙ…Ù ÙˆÙØ§Ø¨Ù’Ù†ÙØ§Ù‡Ù ÙƒÙØ§ÙÙØ±ÙØ§Ù†ÙØŒ ÙÙØ£ÙØ±ÙØ§Ø¯Ù Ø£ÙÙ†Ù’ ÙŠÙÙƒÙ’Ø±ÙÙ‡ÙÙ‡ÙÙ…ÙØ§ ÙÙÙ†ÙØ²ÙÙ„ÙØªÙ’ Ù‡ÙØ°ÙÙ‡Ù Ø§Ù„Ù’Ø¢ÙŠÙØ©Ù ØªÙÙ…Ù’Ù†ÙØ¹Ù Ù…ÙÙ†Ù’ Ø°ÙÙ„ÙÙƒÙ."
    },
    {
        "source": "az-Zuhaili",
        "surah": "Ø§Ù„Ø¨Ù‚Ø±Ø©",
        "ayah": "256",
        "reference": "2:256",
        "theme": "Ù„Ø§ Ø¥ÙƒØ±Ø§Ù‡ ÙÙŠ Ø§Ù„Ø¯ÙŠÙ†",
        "text": "Ù‡ÙØ°ÙÙ‡Ù Ø§Ù„Ù’Ø¢ÙŠÙØ©Ù Ø§Ù„Ù’ÙƒÙØ±ÙÙŠÙ…ÙØ©Ù ØªÙØ¹ÙØ¯ÙÙ‘ Ù…ÙÙ†Ù’ Ø£ÙØ³ÙØ³Ù Ø§Ù„ØªÙÙ‘Ø³ÙØ§Ù…ÙØ­Ù Ø§Ù„Ø¯ÙÙ‘ÙŠÙ†ÙÙŠÙÙ‘ ÙÙÙŠ Ø§Ù„Ù’Ø¥ÙØ³Ù’Ù„ÙØ§Ù…Ù. ÙÙØ§Ù„Ø¯ÙÙ‘ÙŠÙ†Ù Ø¹ÙÙ†Ù’Ø¯Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø£ÙÙ†Ù’ ÙŠÙÙ†Ù’Ù‚ÙØ§Ø¯Ù Ø§Ù„Ù’Ø¹ÙØ¨Ù’Ø¯Ù Ø¹ÙÙ†Ù’ ÙŠÙÙ‚ÙÙŠÙ†ÙØŒ Ù„ÙØ§ Ø¹ÙÙ†Ù’ Ø¬ÙØ¨Ù’Ø±Ù Ø£ÙÙˆÙ’ Ù‚ÙØ³Ù’Ø±Ù."
    },
    {
        "source": "al-Qurthubi",
        "surah": "Ø§Ù„ÙƒØ§ÙØ±ÙˆÙ†",
        "ayah": "6",
        "reference": "109:6",
        "theme": "Ù„ÙƒÙ… Ø¯ÙŠÙ†ÙƒÙ… ÙˆÙ„ÙŠ Ø¯ÙŠÙ†",
        "text": "Ù†ÙØ²ÙÙ„ÙØªÙ’ Ù‡ÙØ°ÙÙ‡Ù Ø§Ù„Ø³ÙÙ‘ÙˆØ±ÙØ©Ù ÙÙÙŠ Ø±ÙØ¯ÙÙ‘ Ø§Ù„Ù†ÙÙ‘Ø¨ÙÙŠÙÙ‘ ï·º Ø¹ÙÙ„ÙÙ‰ Ù‚ÙÙˆÙ’Ù…ÙÙ‡Ù Ø§Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù Ù‚ÙØ§Ù„ÙÙˆØ§: ØªÙØ¹ÙØ§Ù„Ù Ù†ÙØ¹Ù’Ø¨ÙØ¯Ù Ù…ÙØ§ ØªÙØ¹Ù’Ø¨ÙØ¯Ù ÙˆÙØªÙØ¹Ù’Ø¨ÙØ¯Ù Ù…ÙØ§ Ù†ÙØ¹Ù’Ø¨ÙØ¯Ù. ÙÙØ£ÙØ®Ù’Ø¨ÙØ±ÙÙ‡ÙÙ…Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø£ÙÙ†ÙÙ‘ Ø§Ù„Ø¯ÙÙ‘ÙŠÙ†Ù Ù„ÙØ§ ÙŠÙØ¬Ù’Ù…ÙØ¹Ù Ø¨ÙÙŠÙ’Ù†Ù Ø§Ù„ØªÙÙ‘Ù†ÙØ§Ù‚ÙØ¶ÙØŒ ÙˆÙØ£ÙÙ…ÙØ±ÙÙ‡Ù Ø¨ÙØ§Ù„Ù’Ø¨ÙØ±ÙØ§Ø¡ÙØ©Ù Ù…ÙÙ†Ù’ Ø¹ÙØ¨ÙØ§Ø¯ÙØªÙÙ‡ÙÙ…Ù’ØŒ ÙˆÙÙ„ÙÙƒÙÙ†Ù’ Ø¨ÙØ§Ù„Ù„ÙÙ‘ÙŠÙ†Ù ÙˆÙØ§Ù„Ù’Ø¥ÙØ­Ù’Ø³ÙØ§Ù†Ù."
    },
    {
        "source": "az-Zuhaili",
        "surah": "Ø§Ù„ÙƒØ§ÙØ±ÙˆÙ†",
        "ayah": "6",
        "reference": "109:6",
        "theme": "Ù„ÙƒÙ… Ø¯ÙŠÙ†ÙƒÙ… ÙˆÙ„ÙŠ Ø¯ÙŠÙ†",
        "text": "Ù‚ÙÙˆÙ’Ù„ÙÙ‡Ù: {Ù„ÙÙƒÙÙ…Ù’ Ø¯ÙÙŠÙ†ÙÙƒÙÙ…Ù’ ÙˆÙÙ„ÙÙŠÙ Ø¯ÙÙŠÙ†Ù} Ø¯ÙÙ„ÙÙŠÙ„ÙŒ Ø¹ÙÙ„ÙÙ‰ Ø¬ÙÙˆÙØ§Ø²Ù Ø§Ù„Ù’Ø¹ÙÙŠÙ’Ø´Ù Ø§Ù„Ø³ÙÙ‘Ù„ÙÙŠÙ…Ù Ù…ÙØ¹Ù ØºÙÙŠÙ’Ø±Ù Ø§Ù„Ù’Ù…ÙØ³Ù’Ù„ÙÙ…ÙÙŠÙ†Ù Ø¨ÙØºÙÙŠÙ’Ø±Ù ØªÙØ¨ÙØ§Ø¯ÙÙ„Ù ÙÙÙŠ Ø§Ù„Ù’Ø¹ÙÙ‚ÙØ§Ø¦ÙØ¯ÙØŒ ÙˆÙÙ‡ÙÙˆÙ Ù…ÙÙ†Ù’ Ù…ÙÙ‚ÙØ§ØµÙØ¯Ù Ø§Ù„Ø´ÙÙ‘Ø±ÙÙŠØ¹ÙØ©Ù ÙÙÙŠ Ø­ÙÙÙ’Ø¸Ù Ø§Ù„Ø¯ÙÙ‘ÙŠÙ†Ù ÙˆÙØ§Ù„Ù†ÙÙ‘ÙÙ’Ø³Ù."
    },
    {
        "source": "al-Qurthubi",
        "surah": "Ø§Ù„Ø­Ø¬Ø±Ø§Øª",
        "ayah": "13",
        "reference": "49:13",
        "theme": "ÙŠØ§ Ø£ÙŠÙ‡Ø§ Ø§Ù„Ù†Ø§Ø³ Ø¥Ù†Ø§ Ø®Ù„Ù‚Ù†Ø§ÙƒÙ…",
        "text": "Ù‡ÙØ°ÙÙ‡Ù Ø§Ù„Ù’Ø¢ÙŠÙØ©Ù ØªÙÙ†Ù’Ù‡ÙÙ‰ Ø¹ÙÙ†Ù Ø§Ù„ØªÙÙ‘ÙÙØ§Ø®ÙØ±Ù Ø¨ÙØ§Ù„Ù’Ø£ÙÙ†Ù’Ø³ÙØ§Ø¨Ù ÙˆÙØ§Ù„Ù’Ø£ÙØ¹Ù’Ø±ÙØ§Ù‚ÙØŒ ÙˆÙØªÙØ¨ÙÙŠÙÙ‘Ù†Ù Ø£ÙÙ†ÙÙ‘ Ø§Ù„ØªÙÙ‘ÙÙØ§Ø¶ÙÙ„Ù Ø¥ÙÙ†ÙÙ‘Ù…ÙØ§ Ù‡ÙÙˆÙ Ø¨ÙØ§Ù„ØªÙÙ‘Ù‚Ù’ÙˆÙÙ‰. ÙˆÙÙ‡ÙØ°ÙØ§ Ù…ÙÙ†Ù’ Ù…ÙÙ‚ÙØ§ØµÙØ¯Ù Ø§Ù„Ø´ÙÙ‘Ø±ÙÙŠØ¹ÙØ©Ù ÙÙÙŠ Ø¥ÙÙ‚ÙØ§Ù…ÙØ©Ù Ø§Ù„Ù’Ø¹ÙØ¯Ù’Ù„Ù Ø¨ÙÙŠÙ’Ù†Ù Ø§Ù„Ù’Ø¹ÙØ¨ÙØ§Ø¯Ù."
    },
    {
        "source": "az-Zuhaili",
        "surah": "Ø§Ù„Ø­Ø¬Ø±Ø§Øª",
        "ayah": "13",
        "reference": "49:13",
        "theme": "ÙŠØ§ Ø£ÙŠÙ‡Ø§ Ø§Ù„Ù†Ø§Ø³ Ø¥Ù†Ø§ Ø®Ù„Ù‚Ù†Ø§ÙƒÙ…",
        "text": "Ø§Ù„Ù’Ø¢ÙŠÙØ©Ù ØªÙØ¨ÙÙŠÙÙ‘Ù†Ù Ø£ÙÙ†ÙÙ‘ Ø§Ù„Ù’Ø¥ÙÙ†Ù’Ø³ÙØ§Ù†Ù Ù„ÙØ§ ÙŠÙØªÙÙÙØ¶ÙÙ‘Ù„Ù Ø¹ÙÙ„ÙÙ‰ ØºÙÙŠÙ’Ø±ÙÙ‡Ù Ø¨ÙØ§Ù„Ù’Ø¹ÙØ±Ù’Ù‚Ù Ø£ÙÙˆÙ Ø§Ù„Ù„ÙÙ‘ÙˆÙ’Ù†ÙØŒ ÙˆÙØ¥ÙÙ†ÙÙ‘Ù…ÙØ§ Ø¨ÙØ§Ù„ØªÙÙ‘Ù‚Ù’ÙˆÙÙ‰. ÙˆÙÙ‡ÙØ°ÙØ§ ÙŠÙÙ†ÙØ¨ÙÙ‘Ù‡Ù Ø¹ÙÙ„ÙÙ‰ Ù…ÙÙƒÙØ§Ù†ÙØ©Ù Ø§Ù„Ù’Ø¹ÙØ¯Ù’Ù„Ù ÙÙÙŠ Ø§Ù„Ù’Ø¥ÙØ³Ù’Ù„ÙØ§Ù…Ù."
    },
    {
        "source": "al-Qurthubi",
        "surah": "Ø§Ù„Ù…Ù…ØªØ­Ù†Ø©",
        "ayah": "8",
        "reference": "60:8",
        "theme": "Ù„Ø§ ÙŠÙ†Ù‡Ø§ÙƒÙ… Ø§Ù„Ù„Ù‡ Ø¹Ù† Ø§Ù„Ø°ÙŠÙ† Ù„Ù… ÙŠÙ‚Ø§ØªÙ„ÙˆÙƒÙ…",
        "text": "Ø£ÙØ°ÙÙ†Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ù„ÙÙ„Ù’Ù…ÙØ³Ù’Ù„ÙÙ…ÙÙŠÙ†Ù ÙÙÙŠ Ø¨ÙØ±ÙÙ‘ Ø§Ù„Ù’ÙƒÙØ§ÙÙØ±ÙÙŠÙ†Ù ÙˆÙØ¥ÙØ­Ù’Ø³ÙØ§Ù†ÙÙ‡ÙÙ…Ù’ Ø¥ÙÙ„ÙÙŠÙ’Ù‡ÙÙ…Ù’ Ø¥ÙØ°ÙØ§ Ù„ÙÙ…Ù’ ÙŠÙØ­ÙØ§Ø±ÙØ¨ÙÙˆÙ‡ÙÙ…Ù’ ÙÙÙŠ Ø§Ù„Ø¯ÙÙ‘ÙŠÙ†ÙØŒ ÙˆÙÙ„ÙÙ…Ù’ ÙŠÙØ®Ù’Ø±ÙØ¬ÙÙˆÙ‡ÙÙ…Ù’ Ù…ÙÙ†Ù’ Ø¯ÙÙŠÙØ§Ø±ÙÙ‡ÙÙ…Ù’. ÙˆÙÙ‡ÙØ°ÙØ§ Ø¯ÙÙ„ÙÙŠÙ„ÙŒ Ø¹ÙÙ„ÙÙ‰ Ø±ÙØ­Ù’Ù…ÙØ©Ù Ø§Ù„Ù’Ø¥ÙØ³Ù’Ù„ÙØ§Ù…Ù."
    },
    {
        "source": "az-Zuhaili",
        "surah": "Ø§Ù„Ù…Ù…ØªØ­Ù†Ø©",
        "ayah": "8",
        "reference": "60:8",
        "theme": "Ù„Ø§ ÙŠÙ†Ù‡Ø§ÙƒÙ… Ø§Ù„Ù„Ù‡ Ø¹Ù† Ø§Ù„Ø°ÙŠÙ† Ù„Ù… ÙŠÙ‚Ø§ØªÙ„ÙˆÙƒÙ…",
        "text": "Ø§Ù„Ù’Ø¢ÙŠÙØ©Ù ØªÙØ¨ÙÙŠÙÙ‘Ù†Ù Ø£ÙÙ†ÙÙ‘ Ø§Ù„Ù’Ù…ÙØ³Ù’Ù„ÙÙ…Ù Ù„ÙØ§ ÙŠÙÙ†Ù’Ù‡ÙÙ‰ Ø¹ÙÙ†Ù’ Ø¨ÙØ±ÙÙ‘ Ù…ÙÙ†Ù’ Ù„ÙÙ…Ù’ ÙŠÙØ¹ÙØ§Ø¯ÙÙ‡ÙØŒ ÙˆÙÙ„ÙÙˆÙ’ ÙƒÙØ§Ù†Ù ÙƒÙØ§ÙÙØ±Ù‹Ø§. ÙˆÙØ§Ù„Ù’Ø¨ÙØ±ÙÙ‘ ÙŠÙØ´Ù’Ù…ÙÙ„Ù Ø§Ù„Ù’Ù‚ÙÙŠÙØ§Ù…Ù Ø¨ÙØ§Ù„Ù’Ø¹ÙÙ‡Ù’Ø¯ÙØŒ ÙˆÙØ§Ù„Ù’Ø¥ÙØ­Ù’Ø³ÙØ§Ù†Ù ÙÙÙŠ Ø§Ù„Ù’Ù…ÙØ¹ÙØ§Ù…ÙÙ„ÙØ©Ù."
    },
    {
        "source": "al-Qurthubi",
        "surah": "Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª",
        "ayah": "46",
        "reference": "29:46",
        "theme": "ÙˆÙ„Ø§ ØªØ¬Ø§Ø¯Ù„ÙˆØ§ Ø£Ù‡Ù„ Ø§Ù„ÙƒØªØ§Ø¨ Ø¥Ù„Ø§ Ø¨Ø§Ù„ØªÙŠ Ù‡ÙŠ Ø£Ø­Ø³Ù†",
        "text": "Ø£ÙÙ…ÙØ±Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ù†ÙØ¨ÙÙŠÙÙ‘Ù‡Ù Ø£ÙÙ†Ù’ Ù„ÙØ§ ÙŠÙØ¬ÙØ§Ø¯ÙÙ„Ù Ø£ÙÙ‡Ù’Ù„Ù Ø§Ù„Ù’ÙƒÙØªÙØ§Ø¨Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ø¨ÙØ§Ù„Ù’Ø­ÙØ¬ÙÙ‘Ø©Ù Ø§Ù„Ù’Ø¨ÙØ§Ù„ÙØºÙØ©Ù ÙˆÙØ§Ù„Ù’Ø®ÙØ·ÙØ§Ø¨Ù Ø§Ù„Ù’Ø­ÙØ³ÙÙ†ÙØŒ ÙˆÙØ£ÙÙ†Ù’ ÙŠÙØ¨ÙÙŠÙÙ‘Ù†Ù Ù„ÙÙ‡ÙÙ…Ù’ ÙˆÙØ­Ù’Ø¯ÙØ§Ù†ÙÙŠÙÙ‘Ø©Ù Ø§Ù„Ù„ÙÙ‘Ù‡ÙØŒ ÙˆÙØ£ÙÙ†ÙÙ‘ Ø¯ÙÙŠÙ†Ù Ø§Ù„Ù’Ø¥ÙØ³Ù’Ù„ÙØ§Ù…Ù Ù‡ÙÙˆÙ Ø§Ø³Ù’ØªÙÙ…Ù’Ø±ÙØ§Ø±Ù Ø¯ÙÙŠÙ†Ù Ø§Ù„Ù’Ø£ÙÙ†Ù’Ø¨ÙÙŠÙØ§Ø¡Ù."
    },
    {
        "source": "az-Zuhaili",
        "surah": "Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª",
        "ayah": "46",
        "reference": "29:46",
        "theme": "ÙˆÙ„Ø§ ØªØ¬Ø§Ø¯Ù„ÙˆØ§ Ø£Ù‡Ù„ Ø§Ù„ÙƒØªØ§Ø¨ Ø¥Ù„Ø§ Ø¨Ø§Ù„ØªÙŠ Ù‡ÙŠ Ø£Ø­Ø³Ù†",
        "text": "Ø§Ù„Ù’Ø¢ÙŠÙØ©Ù ØªÙØ¯Ù’Ø¹ÙÙˆ Ø¥ÙÙ„ÙÙ‰ Ø§Ù„Ù’Ø­ÙÙˆÙØ§Ø±Ù Ø§Ù„Ù’Ù…ÙØªÙÙ…ÙØ¯ÙÙ‘Ù†Ù Ù…ÙØ¹Ù Ø£ÙÙ‡Ù’Ù„Ù Ø§Ù„Ù’ÙƒÙØªÙØ§Ø¨ÙØŒ ÙˆÙØ§Ù„Ù’Ø¬ÙØ¯ÙØ§Ù„Ù Ø¨ÙØ§Ù„Ù’Ø­ÙØ¬ÙÙ‘Ø©Ù ÙˆÙØ§Ù„Ù’Ø¨ÙÙŠÙØ§Ù†ÙØŒ ÙˆÙØªÙÙ†Ù’Ù‡ÙÙ‰ Ø¹ÙÙ†Ù Ø§Ù„Ù’Ø¹ÙØ¯ÙØ§ÙˆÙØ©Ù ÙˆÙØ§Ù„Ù’ÙƒÙØ±ÙØ§Ù‡ÙÙŠÙÙ‘Ø©Ù."
    },
    {
        "source": "al-Qurthubi",
        "surah": "ÙŠÙˆÙ†Ø³",
        "ayah": "41",
        "reference": "10:41",
        "theme": "ÙˆÙ„Ùˆ Ø´Ø§Ø¡ Ø±Ø¨Ùƒ Ù„Ø¢Ù…Ù† Ù…Ù† ÙÙŠ Ø§Ù„Ø£Ø±Ø¶ ÙƒÙ„Ù‡Ù… Ø¬Ù…ÙŠØ¹Ø§Ù‹",
        "text": "ÙˆÙÙ„ÙÙˆÙ’ Ø´ÙØ§Ø¡Ù Ø±ÙØ¨ÙÙ‘ÙƒÙ Ù„ÙØ¢Ù…ÙÙ†Ù Ù…ÙÙ† ÙÙÙŠ Ø§Ù„Ù’Ø£ÙØ±Ù’Ø¶Ù ÙƒÙÙ„ÙÙ‘Ù‡ÙÙ…Ù’ Ø¬ÙÙ…ÙÙŠØ¹Ù‹Ø§. Ø£ÙÙÙØ£ÙÙ†ØªÙ ØªÙÙƒÙ’Ø±ÙÙ‡Ù Ø§Ù„Ù†ÙÙ‘Ø§Ø³Ù Ø­ÙØªÙÙ‘Ù‰ ÙŠÙÙƒÙÙˆÙ†ÙÙˆØ§ Ù…ÙØ¤Ù’Ù…ÙÙ†ÙÙŠÙ†ÙØŸ"
    },
    {
        "source": "az-Zuhaili",
        "surah": "ÙŠÙˆÙ†Ø³",
        "ayah": "41",
        "reference": "10:41",
        "theme": "ÙˆÙ„Ùˆ Ø´Ø§Ø¡ Ø±Ø¨Ùƒ Ù„Ø¢Ù…Ù† Ù…Ù† ÙÙŠ Ø§Ù„Ø£Ø±Ø¶ ÙƒÙ„Ù‡Ù… Ø¬Ù…ÙŠØ¹Ø§Ù‹",
        "text": "Ø¢ÙŠØ© ÙˆØ§Ø¶Ø­Ø© Ø¹Ù„Ù‰ Ø£Ù† Ø§Ù„Ø¥ÙŠÙ…Ø§Ù† Ù„Ø§ ÙŠÙƒÙˆÙ† Ø¨Ø§Ù„Ø¥ÙƒØ±Ø§Ù‡ØŒ ÙˆØ¥Ù†Ù…Ø§ ÙŠÙƒÙˆÙ† Ø¨Ø§Ù„Ù‡Ø¯Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ù„Ù‡ØŒ ÙÙ„Ø§ ÙŠØ¬ÙˆØ² Ù„Ø£Ø­Ø¯ Ø£Ù† ÙŠØ¬Ø¨Ø± Ø§Ù„Ù†Ø§Ø³ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø³Ù„Ø§Ù…."
    },
    {
        "source": "al-Qurthubi",
        "surah": "Ø§Ù„Ø£Ù†Ø¹Ø§Ù…",
        "ayah": "108",
        "reference": "6:108",
        "theme": "ÙˆÙ„Ø§ ØªØ³Ø¨ÙˆØ§ Ø§Ù„Ø°ÙŠÙ† ÙŠØ¯Ø¹ÙˆÙ† Ù…Ù† Ø¯ÙˆÙ† Ø§Ù„Ù„Ù‡",
        "text": "ÙˆÙÙ„ÙØ§ ØªÙØ³ÙØ¨ÙÙ‘ÙˆØ§ Ø§Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù ÙŠÙØ¯Ù’Ø¹ÙÙˆÙ†Ù Ù…ÙÙ† Ø¯ÙÙˆÙ†Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù ÙÙÙŠÙØ³ÙØ¨ÙÙ‘ÙˆØ§ Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø¹ÙØ¯Ù’ÙˆÙ‹Ø§ Ø¨ÙØºÙÙŠÙ’Ø±Ù Ø¹ÙÙ„Ù’Ù…Ù. ÙƒÙØ°ÙÙ„ÙÙƒÙ Ø²ÙÙŠÙÙ‘Ù†ÙÙ‘Ø§ Ù„ÙÙƒÙÙ„ÙÙ‘ Ø£ÙÙ…ÙÙ‘Ø©Ù Ø¹ÙÙ…ÙÙ„ÙÙ‡ÙÙ…Ù’ Ø«ÙÙ…ÙÙ‘ Ø¥ÙÙ„ÙÙ‰ Ø±ÙØ¨ÙÙ‘Ù‡ÙÙ… Ù…ÙÙ‘Ø±Ù’Ø¬ÙØ¹ÙÙ‡ÙÙ…Ù’ ÙÙÙŠÙÙ†ÙØ¨ÙÙ‘Ø¦ÙÙ‡ÙÙ… Ø¨ÙÙ…ÙØ§ ÙƒÙØ§Ù†ÙÙˆØ§ ÙŠÙØ¹Ù’Ù…ÙÙ„ÙÙˆÙ†Ù."
    },
    {
        "source": "az-Zuhaili",
        "surah": "Ø§Ù„Ø£Ù†Ø¹Ø§Ù…",
        "ayah": "108",
        "reference": "6:108",
        "theme": "ÙˆÙ„Ø§ ØªØ³Ø¨ÙˆØ§ Ø§Ù„Ø°ÙŠÙ† ÙŠØ¯Ø¹ÙˆÙ† Ù…Ù† Ø¯ÙˆÙ† Ø§Ù„Ù„Ù‡",
        "text": "Ø§Ù„Ø¢ÙŠØ© ØªÙ†Ù‡Ù‰ Ø¹Ù† Ø³Ø¨ Ø§Ù„Ø¢Ù„Ù‡Ø© orang kafir karena dapat memicu balas dendam terhadap Allah, menunjukkan etika berdialog yang tinggi."
    }
]

def compare_tafsir(theme_key="Ù„Ø§ Ø¥ÙƒØ±Ø§Ù‡ ÙÙŠ Ø§Ù„Ø¯ÙŠÙ†"):
    results = []
    for item in tafsir_data:
        if theme_key.lower() in item["theme"].lower() or theme_key == "all":
            clean_text = normalize_arabic(item["text"])
            probs, used = predict_sentiment(clean_text, "Ensemble")
            label, conf = probs_to_label(probs)
            ctx = ", ".join([p for p in toleransi_phrases.get("toleran", []) if p in clean_text]) or "-"
            maq = ", ".join([m for m, kws in maqashid_map.items() if any(kw in clean_text for kw in kws)]) or "-"
            results.append({
                "Sumber": item["source"],
                "Ayat": f"{item['surah']}:{item['ayah']}",
                "Tema": item["theme"],
                "Sentimen": label,
                "P(Toleran)": round(probs["positive"], 3),
                "Maqashid": maq,
                "Frasa Toleran": ctx
            })
    return pd.DataFrame(results)

# 15) GRADIO DASHBOARD
with gr.Blocks(theme=gr.themes.Soft(), title="Dashboard: Analisis Toleransi Tafsir (Data Asli + Hermeneutik Lanjut)") as demo:
    gr.Markdown("## ğŸ•Œ DASHBOARD: ANALISIS TOLERANSI TAFSIR AL-QUR'AN (DATA ASLI + HERMENEUTIK LANJUT)")
    with gr.Tab("ğŸ” Analisis Tunggal"):
        inp = gr.Textbox(label="Teks Tafsir (Arab)", lines=7, placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ù†Øµ Ù‡Ù†Ø§...")
        mode = gr.Dropdown(["Ensemble","AraBERT only","CAMeLBERT only"], value="Ensemble")
        btn = gr.Button("ğŸ” ANALISIS", variant="primary")
        out_text = gr.Textbox(label="ğŸ”¤ Teks + Highlight", lines=6)
        out_table = gr.DataFrame(label="ğŸ“Š Tabel Kata")
        out_stats = gr.Textbox(label="ğŸ“ˆ Statistik", lines=6)
        out_ctx = gr.Textbox(label="ğŸ“Œ Frasa Toleran", lines=3)
        out_maq = gr.Textbox(label="ğŸ¯ Maqashid", lines=3)
        out_ayat = gr.Textbox(label="ğŸ“– Ayat Penguat", lines=4)
        out_warn = gr.Textbox(label="âš ï¸ Peringatan Kontekstual", lines=6)
        out_plot = gr.Image(label="ğŸ–¼ï¸ Distribusi Kata")
        out_plot_sent = gr.Image(label="ğŸ“‰ Sentimen per Kalimat")
        out_kwic = gr.DataFrame(label="ğŸ” KWIC: Keyword-in-Context")
        out_herm = gr.Textbox(label="ğŸ” Hermeneutik (Lengkap)", lines=12)
        btn.click(
            fn=analyze_text,
            inputs=[inp, mode],
            outputs=[
                out_text, out_table, out_stats, out_ctx, out_maq, out_ayat,
                out_warn, out_plot, out_plot_sent, out_kwic, out_herm
            ]
        )

    with gr.Tab("âš–ï¸ Perbandingan Tafsir"):
        gr.Markdown("### ğŸ“Š Bandingkan Tafsir al-Qurthubi & az-Zuhaili â€” Ayat Toleransi (Data Asli)")
        theme_choice = gr.Dropdown(
            choices=[
                "Ù„Ø§ Ø¥ÙƒØ±Ø§Ù‡ ÙÙŠ Ø§Ù„Ø¯ÙŠÙ†",
                "Ù„ÙƒÙ… Ø¯ÙŠÙ†ÙƒÙ… ÙˆÙ„ÙŠ Ø¯ÙŠÙ†",
                "ÙŠØ§ Ø£ÙŠÙ‡Ø§ Ø§Ù„Ù†Ø§Ø³ Ø¥Ù†Ø§ Ø®Ù„Ù‚Ù†Ø§ÙƒÙ…",
                "Ù„Ø§ ÙŠÙ†Ù‡Ø§ÙƒÙ… Ø§Ù„Ù„Ù‡ Ø¹Ù† Ø§Ù„Ø°ÙŠÙ† Ù„Ù… ÙŠÙ‚Ø§ØªÙ„ÙˆÙƒÙ…",
                "ÙˆÙ„Ø§ ØªØ¬Ø§Ø¯Ù„ÙˆØ§ Ø£Ù‡Ù„ Ø§Ù„ÙƒØªØ§Ø¨ Ø¥Ù„Ø§ Ø¨Ø§Ù„ØªÙŠ Ù‡ÙŠ Ø£Ø­Ø³Ù†",
                "ÙˆÙ„Ùˆ Ø´Ø§Ø¡ Ø±Ø¨Ùƒ Ù„Ø¢Ù…Ù† Ù…Ù† ÙÙŠ Ø§Ù„Ø£Ø±Ø¶ ÙƒÙ„Ù‡Ù… Ø¬Ù…ÙŠØ¹Ø§Ù‹",
                "ÙˆÙ„Ø§ ØªØ³Ø¨ÙˆØ§ Ø§Ù„Ø°ÙŠÙ† ÙŠØ¯Ø¹ÙˆÙ† Ù…Ù† Ø¯ÙˆÙ† Ø§Ù„Ù„Ù‡",
                "all"
            ],
            value="Ù„Ø§ Ø¥ÙƒØ±Ø§Ù‡ ÙÙŠ Ø§Ù„Ø¯ÙŠÙ†",
            label="Pilih Tema Ayat"
        )
        btn_comp = gr.Button("ğŸ“Š BANDINGKAN")
        out_comp_table = gr.DataFrame()
        btn_comp.click(compare_tafsir, theme_choice, out_comp_table)

    with gr.Tab("ğŸ§ª Evaluasi CSV"):
        file_csv = gr.File(label="ğŸ“ Upload CSV")
        mode_eval = gr.Dropdown(["Ensemble","AraBERT only","CAMeLBERT only"], value="Ensemble")
        btn_eval = gr.Button("ğŸ“ Evaluasi")
        out_summary = gr.Textbox(lines=18)
        out_cm = gr.Image()
        out_dl = gr.File()
        btn_eval.click(evaluate_csv, [file_csv, mode_eval], [out_summary, out_cm, out_dl])

    with gr.Tab("â„¹ï¸ Tentang"):
        about = (
            "Pipeline: Hybrid Ensemble + Rule-based + Hermeneutika\n"
            f"Status: CAMeLBERT={'OK' if camel_loaded else 'FAIL'}, AraBERT={'OK' if arabert_loaded else 'FAIL'}, SBERT={'OK' if sbert_loaded else 'FAIL'}\n"
            "Fitur: Analisis Tunggal, Perbandingan Tafsir, Evaluasi, Hermeneutik, Semantic Similarity, Topic Modeling\n"
            f"Error CAMeLBERT: {camel_err or '-'}\n"
            f"Error AraBERT: {arabert_err or '-'}\n"
            f"Error SBERT: {sbert_err or '-'}\n"
            "ğŸ“š Sumber Tafsir:\n"
            "- al-Qurthubi: Al-Jamiâ€™ li-Ahkam al-Qurâ€™an\n"
            "- az-Zuhaili: Al-Tafsir al-Munir\n"
        )
        gr.Textbox(value=about, label="Info", lines=14, interactive=False)

print("âœ… Semua siap. Menjalankan dashboard...")
demo.launch(share=True, show_error=True)
